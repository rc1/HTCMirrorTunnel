"use strict";function makeWebSocketClient(e){return W.promise(function(n,t){console.log("Connecting to websocket client:",e.wsUrl),e.wsClient=new W.JSONSocketConnection({socketUrl:e.wsUrl});var r=once(function(){$("[data-disconnected-warning]").remove(),report("CONNECTED","to:",e.wsUrl),n(e)});e.wsClient.on("open",r),e.wsClient.on("error",makeReporter("Web Socket Error")),e.wsClient.on("close",makeReporter("Web Socket Close")),e.wsClient.openSocketConnection()})}function makePunterVizs(e){return W.promise(function(n,t){$("[data-punter-viz]").toArray().map(function(n){e.punterViz=PunterViz.makeApp(),e.punterViz.containerEl=n,PunterViz.initApp(e.punterViz).error(function(e){console.error("Failed to create Punter app",e)}).success(function(e){console.log("Punter application made")})}),n(e)})}function makeRestRadioButtons(e){return W.promise(function(n,t){$('[data-rest-type="radio-post"]').toArray().map($).map(function(n){var t=n.parent();t.on("click touchend",function(t){return t.preventDefault(),console.log("sending",n.val(),"to",n.data("restUri")),RestesqueUtil.post(e.wsClient,n.data("restUri"),n.val()),!1})}),$('[data-rest-type="feildset"]').toArray().map($).map(function(n){var t=n.find('input[type="radio"]').checkboxradio();console.log("got a field set",n.data("restUri")),RestesqueUtil.subscribeWithInitialGet(e.wsClient,n.data("restUri"),function(e){t.prop("checked",!1).checkboxradio("refresh").filter('input[value="'+e.getBody()+'"]').attr("checked","checked").checkboxradio("refresh").parent().find("label").removeClass("ui-radio-off").addClass("ui-radio-on")})}),n(e)})}function once(e){var n=!1;return function(){n||(e(),n=!0)}}function report(e,n){console.log("[",e,"]",W.rest(W.toArray(arguments)).join(" "))}function makeReporter(e,n){var t=arguments;return function(){report.apply(this,t);var e=arguments;return W.promise(function(n,t){n.apply(this,e)})}}var PunterViz=function(){function e(){return{containerEl:document.createElement("div"),backroundColor:6382180,preRenderFns:[],preCubeCamRenderFns:[],postCubeCamRenderFns:[]}}function n(e){return W.promise(function(n,t){e.camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,3e3),u(e,0,0,200),e.scene=new THREE.Scene,e.renderer=new THREE.WebGLRenderer({antialias:!1}),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(window.innerWidth,window.innerHeight),e.renderer.setClearColor(e.backgroundColor),e.renderer.sortObjects=!1,e.containerEl.appendChild(e.renderer.domElement),n(e)})}function t(e){return W.promise(function(n,t){var r=document.createElement("video");r.autoplay=!0,navigator.webkitGetUserMedia({video:!0},function(e){r.src=URL.createObjectURL(e)},function(e){console.log("Failed to get a stream due to",e)}),e.webCamTexture=new THREE.Texture(r),e.webCamTexture.minFilter=THREE.LinearFilter,c(e,function(n,t){r.readyState===r.HAVE_ENOUGH_DATA&&(e.webCamTexture.needsUpdate=!0)}),n(e)})}function r(e){return W.promise(function(n,t){e.cubeCamera=new THREE.CubeCamera(1,3e3,256),e.cubeCamera.renderTarget.minFilter=THREE.LinearMipMapLinearFilter,c(e,function(n,t){e.preCubeCamRenderFns.forEach(function(e){return e(n,t)}),e.cubeCamera.updateCubeMap(e.renderer,e.scene),e.postCubeCamRenderFns.forEach(function(e){return e(n,t)})}),n(e)})}function o(e){return W.promise(function(n,t){var r=new THREE.MeshBasicMaterial({map:e.webCamTexture,color:16777215,side:THREE.BackSide});e.webCamvBoxMesh=new THREE.Mesh(new THREE.BoxGeometry(2e3,2e3,2e3),r);var o=W.randomBetween(2e-4,2e-5),i=W.randomBetween(2e-4,2e-5),a=W.randomBetween(2e-4,2e-5);c(e,function(n,t){e.webCamvBoxMesh.rotation.x+=n*o,e.webCamvBoxMesh.rotation.y+=n*i,e.webCamvBoxMesh.rotation.z+=n*a}),e.scene.add(e.webCamvBoxMesh),e.preCubeCamRenderFns.push(function(){e.webCamvBoxMesh.visible=!0}),e.postCubeCamRenderFns.push(function(){e.webCamvBoxMesh.visible=!1}),n(e)})}function i(e){return W.promise(function(n,t){e.scene.add(new THREE.AmbientLight(2236962));var r=new THREE.DirectionalLight(16777215,2);r.position.set(2,1.2,10).normalize(),e.scene.add(r),r=new THREE.DirectionalLight(16777215,1),r.position.set(-2,1.2,-10).normalize(),e.scene.add(r),n(e)})}function a(e){return W.promise(function(n,t){function r(n){{var t=n.children[0],r=100,a=5,s=100;!function c(){if(i.length<r){var n=new o(t);e.swarmObject3D.add(n.anchor),i.push(n),setTimeout(c,W.map(i.length/r,0,1,s,a,W.interpolations.easeIn))}}()}}function o(e){this.velocity=W.randomBetween(.2,1),this.mesh=e.clone(),this.mesh.material=o.material.clone(),this.mesh.scale.x=o.initialScale,this.mesh.scale.y=o.initialScale,this.mesh.scale.z=o.initialScale;var n=100;this.mesh.position.set((Math.random()-.5)*n,(Math.random()-.5)*n,(Math.random()-.5)*n),this.anchor=new THREE.Object3D,this.anchor.add(this.mesh)}var i=[];e.swarmObject3D=new THREE.Object3D,e.scene.add(e.swarmObject3D),e.preCubeCamRenderFns.push(function(){e.swarmObject3D.visible=!1}),e.postCubeCamRenderFns.push(function(){e.swarmObject3D.visible=!0});var a=new THREE.OBJLoader;a.load("/obj/pillow-box.obj",r),c(e,function(e,n){i.forEach(function(t){return t.update(e,n)})}),o.material=new THREE.MeshPhongMaterial({color:16777215,shininess:0,specular:16777215,envMap:e.cubeCamera.renderTarget,reflectivity:1,side:THREE.DoubleSide}),o.initialScale=200,o.prototype.update=function(e,n){this.anchor.rotation.x+=.002,this.anchor.rotation.y+=this.velocity/10,this.anchor.rotation.z+=.001},n(e)})}function s(e){return W.promise(function(n,t){var r=0,o=0;!function i(n){window.requestAnimationFrame(i),o=n-r,r=n,e.preRenderFns.forEach(function(e){return e(o,n)}),e.renderer.clear(),e.renderer.render(e.scene,e.camera)}(r),n(e)})}function c(e,n){e.preRenderFns.push(n)}function u(e,n,t,r){e.camera.position.x=n,e.camera.position.y=t,e.camera.position.z=r}var d=W.composePromisers(n,t,r,o,a,i,s);return{makeApp:e,initApp:d}}(),makeApp=function(){return{wsUrl:W.join("https:"===document.location.protocol?"wss://":"ws://",document.location.host,"/")}},initApp=W.composePromisers(makeWebSocketClient,makePunterVizs,makeRestRadioButtons);$(function(){initApp(makeApp()).success(function(e){report("OK","TheWorkers.net"),window.app=e})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbC5qcyIsIm1haW4uanMiLCJwdW50ZXItdml6LmpzIl0sIm5hbWVzIjpbIm1ha2VXZWJTb2NrZXRDbGllbnQiLCJhcHAiLCJXIiwicHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjb25zb2xlIiwibG9nIiwid3NVcmwiLCJ3c0NsaWVudCIsIkpTT05Tb2NrZXRDb25uZWN0aW9uIiwic29ja2V0VXJsIiwicmVzb2x2ZU9uRmlyc3RDb25uZWN0Iiwib25jZSIsIiQiLCJyZW1vdmUiLCJyZXBvcnQiLCJvbiIsIm1ha2VSZXBvcnRlciIsIm9wZW5Tb2NrZXRDb25uZWN0aW9uIiwibWFrZVB1bnRlclZpenMiLCJ0b0FycmF5IiwibWFwIiwiZWwiLCJwdW50ZXJWaXoiLCJQdW50ZXJWaXoiLCJtYWtlQXBwIiwiY29udGFpbmVyRWwiLCJpbml0QXBwIiwiZXJyb3IiLCJlcnIiLCJzdWNjZXNzIiwiaW5pdGFsaXNlZFB1bnRlckFwcCIsIm1ha2VSZXN0UmFkaW9CdXR0b25zIiwiJGVsIiwiJHdyYXBwZXJFbCIsInBhcmVudCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInZhbCIsImRhdGEiLCJSZXN0ZXNxdWVVdGlsIiwicG9zdCIsInJhZGlvRWxzIiwiZmluZCIsImNoZWNrYm94cmFkaW8iLCJzdWJzY3JpYmVXaXRoSW5pdGlhbEdldCIsInBhY2tldCIsInByb3AiLCJmaWx0ZXIiLCJnZXRCb2R5IiwiYXR0ciIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJmbiIsImhhc1RyaWdnZXJlZCIsInN0YXR1cyIsInN0ciIsInJlc3QiLCJhcmd1bWVudHMiLCJqb2luIiwicmVwb3J0QXJncyIsImFwcGx5IiwidGhpcyIsImNhbGxlZUFyZ3MiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJiYWNrcm91bmRDb2xvciIsInByZVJlbmRlckZucyIsInByZUN1YmVDYW1SZW5kZXJGbnMiLCJwb3N0Q3ViZUNhbVJlbmRlckZucyIsIm1ha2VDYW1lcmFTY2VuZVJlbmRlcmVyIiwiY2FtZXJhIiwiVEhSRUUiLCJQZXJzcGVjdGl2ZUNhbWVyYSIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsInNldENhbWVyYVBvc2l0aW9uIiwic2NlbmUiLCJTY2VuZSIsInJlbmRlcmVyIiwiV2ViR0xSZW5kZXJlciIsImFudGlhbGlhcyIsInNldFBpeGVsUmF0aW8iLCJkZXZpY2VQaXhlbFJhdGlvIiwic2V0U2l6ZSIsInNldENsZWFyQ29sb3IiLCJiYWNrZ3JvdW5kQ29sb3IiLCJzb3J0T2JqZWN0cyIsImFwcGVuZENoaWxkIiwiZG9tRWxlbWVudCIsIm1ha2VXZWJDYW1UZXh0dXJlIiwid2ViQ2FtRWwiLCJhdXRvcGxheSIsIm5hdmlnYXRvciIsIndlYmtpdEdldFVzZXJNZWRpYSIsInZpZGVvIiwic3RyZWFtIiwic3JjIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwid2ViQ2FtVGV4dHVyZSIsIlRleHR1cmUiLCJtaW5GaWx0ZXIiLCJMaW5lYXJGaWx0ZXIiLCJhZGRQcmVSZW5kZXJGbiIsImRldGxhTVMiLCJ0aW1lc3RhbXBNUyIsInJlYWR5U3RhdGUiLCJIQVZFX0VOT1VHSF9EQVRBIiwibmVlZHNVcGRhdGUiLCJtYWtlQ3ViZUNhbSIsImN1YmVDYW1lcmEiLCJDdWJlQ2FtZXJhIiwicmVuZGVyVGFyZ2V0IiwiTGluZWFyTWlwTWFwTGluZWFyRmlsdGVyIiwiZGVsdGFNUyIsImZvckVhY2giLCJ1cGRhdGVDdWJlTWFwIiwibWFrZVdlYkNhbUJveE1lc2giLCJ3ZWJDYW1Cb3hNYXRlcmlhbCIsIk1lc2hCYXNpY01hdGVyaWFsIiwiY29sb3IiLCJzaWRlIiwiQmFja1NpZGUiLCJ3ZWJDYW12Qm94TWVzaCIsIk1lc2giLCJCb3hHZW9tZXRyeSIsInJvdGF0aW9uWCIsInJhbmRvbUJldHdlZW4iLCJyb3RhdGlvblkiLCJyb3RhdGlvbloiLCJyb3RhdGlvbiIsIngiLCJ5IiwieiIsImFkZCIsInB1c2giLCJ2aXNpYmxlIiwibWFrZUxpZ2h0cyIsIkFtYmllbnRMaWdodCIsImRpcmVjdGlvbmFsTGlnaHQiLCJEaXJlY3Rpb25hbExpZ2h0IiwicG9zaXRpb24iLCJzZXQiLCJub3JtYWxpemUiLCJtYWtlU3dhcm0iLCJvbk9iakxvYWRlZCIsIm9iaiIsIm1lc2giLCJjaGlsZHJlbiIsIm1heFBhcnRpY2xlcyIsIm1pbkNyZWF0aW9uVGltZSIsIm1heENyZWF0aW9uVGltZU1TIiwiY3JlYXRlTW9yZSIsInBhcnRpY2xlcyIsImxlbmd0aCIsInBhcnRpY2xlIiwiUGFydGljbGUiLCJzd2FybU9iamVjdDNEIiwiYW5jaG9yIiwic2V0VGltZW91dCIsImludGVycG9sYXRpb25zIiwiZWFzZUluIiwidmVsb2NpdHkiLCJjbG9uZSIsIm1hdGVyaWFsIiwic2NhbGUiLCJpbml0aWFsU2NhbGUiLCJyYW5nZSIsIk1hdGgiLCJyYW5kb20iLCJPYmplY3QzRCIsImxvYWRlciIsIk9CSkxvYWRlciIsImxvYWQiLCJ1cGRhdGUiLCJNZXNoUGhvbmdNYXRlcmlhbCIsInNoaW5pbmVzcyIsInNwZWN1bGFyIiwiZW52TWFwIiwicmVmbGVjdGl2aXR5IiwiRG91YmxlU2lkZSIsInByb3RvdHlwZSIsIm1ha2VSZW5kZXJMb29wIiwibGFzdFRpbWVzdGFtcE1TIiwibG9vcCIsImN1cnJlbnRUaW1lc3RhbXBNUyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNsZWFyIiwicmVuZGVyIiwiY29tcG9zZVByb21pc2VycyIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJob3N0Il0sIm1hcHBpbmdzIjoiQUFRQSxZQ3dCQSxTQUFTQSxxQkFBc0JDLEdBQzNCLE1BQU9DLEdBQUVDLFFBQVMsU0FBV0MsRUFBU0MsR0FDbENDLFFBQVFDLElBQUssa0NBQW1DTixFQUFJTyxPQUVwRFAsRUFBSVEsU0FBVyxHQUFJUCxHQUFFUSxzQkFDakJDLFVBQVdWLEVBQUlPLE9BR25CLElBQUlJLEdBQXdCQyxLQUFNLFdBQzlCQyxFQUFHLCtCQUFnQ0MsU0FDbkNDLE9BQVEsWUFBYSxNQUFPZixFQUFJTyxPQUNoQ0osRUFBU0gsSUFHYkEsR0FBSVEsU0FBU1EsR0FBSSxPQUFRTCxHQUN6QlgsRUFBSVEsU0FBU1EsR0FBSSxRQUFTQyxhQUFjLHFCQUN4Q2pCLEVBQUlRLFNBQVNRLEdBQUksUUFBU0MsYUFBYyxxQkFDeENqQixFQUFJUSxTQUFTVSx5QkFRckIsUUFBU0MsZ0JBQWlCbkIsR0FDdEIsTUFBT0MsR0FBRUMsUUFBUyxTQUFXQyxFQUFTQyxHQUNsQ1MsRUFBRyxxQkFDRU8sVUFDQUMsSUFBSyxTQUFXQyxHQUVidEIsRUFBSXVCLFVBQVlDLFVBQVVDLFVBRTFCekIsRUFBSXVCLFVBQVVHLFlBQWNKLEVBRzVCRSxVQUNLRyxRQUFTM0IsRUFBSXVCLFdBQ2JLLE1BQU8sU0FBV0MsR0FDZnhCLFFBQVF1QixNQUFPLDhCQUErQkMsS0FFakRDLFFBQVMsU0FBV0MsR0FDakIxQixRQUFRQyxJQUFLLCtCQUk3QkgsRUFBU0gsS0FPakIsUUFBU2dDLHNCQUF1QmhDLEdBQzVCLE1BQU9DLEdBQUVDLFFBQVMsU0FBV0MsRUFBU0MsR0FHbENTLEVBQUcsaUNBQ0VPLFVBQ0FDLElBQUtSLEdBQ0xRLElBQUssU0FBV1ksR0FFYixHQUFJQyxHQUFhRCxFQUFJRSxRQUNyQkQsR0FBV2xCLEdBQUksaUJBQWtCLFNBQVdvQixHQUl4QyxNQUhBQSxHQUFFQyxpQkFDRmhDLFFBQVFDLElBQUssVUFBVTJCLEVBQUlLLE1BQU8sS0FBTUwsRUFBSU0sS0FBTSxZQUNsREMsY0FBY0MsS0FBTXpDLEVBQUlRLFNBQVV5QixFQUFJTSxLQUFNLFdBQWFOLEVBQUlLLFFBQ3RELE1BTW5CekIsRUFBRywrQkFDRU8sVUFDQUMsSUFBS1IsR0FDTFEsSUFBSyxTQUFXWSxHQUViLEdBQUlTLEdBQVdULEVBQUlVLEtBQU0sdUJBQXdCQyxlQUVqRHZDLFNBQVFDLElBQU0sa0JBQW1CMkIsRUFBSU0sS0FBTSxZQUMzQ0MsY0FBY0ssd0JBQXlCN0MsRUFBSVEsU0FBVXlCLEVBQUlNLEtBQU0sV0FBYSxTQUFXTyxHQUNuRkosRUFDS0ssS0FBTSxXQUFXLEdBQ2pCSCxjQUFlLFdBQ2ZJLE9BQVEsZ0JBQWlCRixFQUFPRyxVQUFXLE1BQzNDQyxLQUFNLFVBQVcsV0FDakJOLGNBQWUsV0FDZlQsU0FDQVEsS0FBTSxTQUNOUSxZQUFhLGdCQUNiQyxTQUFVLG1CQUkzQmpELEVBQVNILEtBVWpCLFFBQVNZLE1BQU95QyxHQUNaLEdBQUlDLElBQWUsQ0FDbkIsT0FBTyxZQUNJQSxJQUNIRCxJQUNBQyxHQUFlLElBUTNCLFFBQVN2QyxRQUFRd0MsRUFBUUMsR0FDckJuRCxRQUFRQyxJQUFLLElBQUtpRCxFQUFRLElBQUt0RCxFQUFFd0QsS0FBTXhELEVBQUVtQixRQUFTc0MsWUFBY0MsS0FBTSxNQUcxRSxRQUFTMUMsY0FBY3NDLEVBQVFDLEdBQzNCLEdBQUlJLEdBQWFGLFNBQ2pCLE9BQU8sWUFDSDNDLE9BQU84QyxNQUFPQyxLQUFNRixFQUNwQixJQUFJRyxHQUFhTCxTQUNqQixPQUFPekQsR0FBRUMsUUFBUyxTQUFXQyxFQUFTQyxHQUNsQ0QsRUFBUTBELE1BQU9DLEtBQU1DLE1DeEpqQyxHQUFJdkMsV0FBYSxXQUliLFFBQVNDLEtBQ0wsT0FDSUMsWUFBYXNDLFNBQVNDLGNBQWUsT0FDckNDLGVBQWdCLFFBQ2hCQyxnQkFDQUMsdUJBQ0FDLHlCQWlCUixRQUFTQyxHQUEwQnRFLEdBQy9CLE1BQU9DLEdBQUVDLFFBQVMsU0FBV0MsRUFBU0MsR0FJbENKLEVBQUl1RSxPQUFTLEdBQUlDLE9BQU1DLGtCQUFtQixHQUFJQyxPQUFPQyxXQUFhRCxPQUFPRSxZQUFhLEVBQUcsS0FDekZDLEVBQW1CN0UsRUFBSyxFQUFHLEVBQUcsS0FJOUJBLEVBQUk4RSxNQUFRLEdBQUlOLE9BQU1PLE1BSXRCL0UsRUFBSWdGLFNBQVcsR0FBSVIsT0FBTVMsZUFBaUJDLFdBQVcsSUFDNURsRixFQUFJZ0YsU0FBU0csY0FBZVQsT0FBT1Usa0JBQ25DcEYsRUFBSWdGLFNBQVNLLFFBQVNYLE9BQU9DLFdBQVlELE9BQU9FLGFBQ3pDNUUsRUFBSWdGLFNBQVNNLGNBQWV0RixFQUFJdUYsaUJBQ3ZDdkYsRUFBSWdGLFNBQVNRLGFBQWMsRUFFcEJ4RixFQUFJMEIsWUFBWStELFlBQWF6RixFQUFJZ0YsU0FBU1UsWUFFMUN2RixFQUFTSCxLQU9qQixRQUFTMkYsR0FBb0IzRixHQUN6QixNQUFPQyxHQUFFQyxRQUFTLFNBQVdDLEVBQVNDLEdBSWxDLEdBQUl3RixHQUFXNUIsU0FBU0MsY0FBYyxRQUN0QzJCLEdBQVNDLFVBQVcsRUFJcEJDLFVBQVVDLG9CQUFzQkMsT0FBTSxHQUFRLFNBQVVDLEdBQ3BETCxFQUFTTSxJQUFNQyxJQUFJQyxnQkFBaUJILElBQ3JDLFNBQVVwRSxHQUNUeEIsUUFBUUMsSUFBSSxnQ0FBaUN1QixLQUtqRDdCLEVBQUlxRyxjQUFnQixHQUFJN0IsT0FBTThCLFFBQVNWLEdBQ3ZDNUYsRUFBSXFHLGNBQWNFLFVBQVkvQixNQUFNZ0MsYUFJcENDLEVBQWdCekcsRUFBSyxTQUFXMEcsRUFBU0MsR0FDakNmLEVBQVNnQixhQUFlaEIsRUFBU2lCLG1CQUNqQzdHLEVBQUlxRyxjQUFjUyxhQUFjLEtBSXhDM0csRUFBU0gsS0FVakIsUUFBUytHLEdBQWMvRyxHQUNuQixNQUFPQyxHQUFFQyxRQUFTLFNBQVdDLEVBQVNDLEdBRWxDSixFQUFJZ0gsV0FBYSxHQUFJeEMsT0FBTXlDLFdBQVcsRUFBRyxJQUFNLEtBQy9DakgsRUFBSWdILFdBQVdFLGFBQWFYLFVBQVkvQixNQUFNMkMseUJBRTlDVixFQUFnQnpHLEVBQUssU0FBV29ILEVBQVNULEdBR3JDM0csRUFBSW9FLG9CQUFvQmlELFFBQVMsU0FBQWhFLEdGSDdCLE1FR21DQSxHQUFJK0QsRUFBU1QsS0FDcEQzRyxFQUFJZ0gsV0FBV00sY0FBZXRILEVBQUlnRixTQUFVaEYsRUFBSThFLE9BQ2hEOUUsRUFBSXFFLHFCQUFxQmdELFFBQVMsU0FBQWhFLEdGRDlCLE1FQ29DQSxHQUFJK0QsRUFBU1QsT0FHekR4RyxFQUFTSCxLQVFqQixRQUFTdUgsR0FBb0J2SCxHQUN6QixNQUFPQyxHQUFFQyxRQUFTLFNBQVdDLEVBQVNDLEdBRWxDLEdBQUlvSCxHQUFvQixHQUFJaEQsT0FBTWlELG1CQUM5QnBHLElBQUtyQixFQUFJcUcsY0FDVHFCLE1BQU8sU0FDZEMsS0FBTW5ELE1BQU1vRCxVQUdUNUgsR0FBSTZILGVBQWlCLEdBQUlyRCxPQUFNc0QsS0FBTSxHQUFJdEQsT0FBTXVELFlBQWEsSUFBTSxJQUFNLEtBQVFQLEVBRWhGLElBQUlRLEdBQVkvSCxFQUFFZ0ksY0FBZSxLQUFRLE1BQ3JDQyxFQUFZakksRUFBRWdJLGNBQWUsS0FBUSxNQUNyQ0UsRUFBWWxJLEVBQUVnSSxjQUFlLEtBQVEsS0FHekN4QixHQUFnQnpHLEVBQUssU0FBV29ILEVBQVNULEdBQ3JDM0csRUFBSTZILGVBQWVPLFNBQVNDLEdBQU9qQixFQUFVWSxFQUM3Q2hJLEVBQUk2SCxlQUFlTyxTQUFTRSxHQUFPbEIsRUFBVWMsRUFDN0NsSSxFQUFJNkgsZUFBZU8sU0FBU0csR0FBT25CLEVBQVVlLElBR3hEbkksRUFBSThFLE1BQU0wRCxJQUFLeEksRUFBSTZILGdCQUdaN0gsRUFBSW9FLG9CQUFvQnFFLEtBQU0sV0FDMUJ6SSxFQUFJNkgsZUFBZWEsU0FBVSxJQUdqQzFJLEVBQUlxRSxxQkFBcUJvRSxLQUFNLFdBQzNCekksRUFBSTZILGVBQWVhLFNBQVUsSUFLakN2SSxFQUFTSCxLQU1qQixRQUFTMkksR0FBYTNJLEdBQ2xCLE1BQU9DLEdBQUVDLFFBQVMsU0FBV0MsRUFBU0MsR0FDbENKLEVBQUk4RSxNQUFNMEQsSUFBSyxHQUFJaEUsT0FBTW9FLGFBQWMsU0FFdkMsSUFBSUMsR0FBbUIsR0FBSXJFLE9BQU1zRSxpQkFBa0IsU0FBVSxFQUNwRUQsR0FBaUJFLFNBQVNDLElBQUssRUFBRyxJQUFLLElBQUtDLFlBQzVDakosRUFBSThFLE1BQU0wRCxJQUFLSyxHQUVmQSxFQUFtQixHQUFJckUsT0FBTXNFLGlCQUFrQixTQUFVLEdBQ3pERCxFQUFpQkUsU0FBU0MsSUFBSyxHQUFJLElBQUssS0FBTUMsWUFDOUNqSixFQUFJOEUsTUFBTTBELElBQUtLLEdBQ1IxSSxFQUFTSCxLQU1qQixRQUFTa0osR0FBWWxKLEdBQ2pCLE1BQU9DLEdBQUVDLFFBQVMsU0FBV0MsRUFBU0MsR0FzQmxDLFFBQVMrSSxHQUFjQyxHQUVuQixDQUFBLEdBQUlDLEdBQU9ELEVBQUlFLFNBQVUsR0FLckJDLEVBQWUsSUFDZkMsRUFBa0IsRUFDbEJDLEVBQW9CLEtBR3ZCLFFBQVNDLEtBQ04sR0FBS0MsRUFBVUMsT0FBU0wsRUFBZSxDQUNuQyxHQUFJTSxHQUFXLEdBQUlDLEdBQVVULEVBQzdCckosR0FBSStKLGNBQWN2QixJQUFLcUIsRUFBU0csUUFDaENMLEVBQVVsQixLQUFNb0IsR0FDaEJJLFdBQVlQLEVBQVl6SixFQUFFb0IsSUFBS3NJLEVBQVVDLE9BQVNMLEVBQWMsRUFBRyxFQUFHRSxFQUFtQkQsRUFBaUJ2SixFQUFFaUssZUFBZUMsY0FZdkksUUFBU0wsR0FBV1QsR0FFaEJ2RixLQUFLc0csU0FBV25LLEVBQUVnSSxjQUFlLEdBQUssR0FHdENuRSxLQUFLdUYsS0FBT0EsRUFBS2dCLFFBQ2pCdkcsS0FBS3VGLEtBQUtpQixTQUFXUixFQUFTUSxTQUFTRCxRQUN2Q3ZHLEtBQUt1RixLQUFLa0IsTUFBTWxDLEVBQUl5QixFQUFTVSxhQUM3QjFHLEtBQUt1RixLQUFLa0IsTUFBTWpDLEVBQUl3QixFQUFTVSxhQUM3QjFHLEtBQUt1RixLQUFLa0IsTUFBTWhDLEVBQUl1QixFQUFTVSxZQUc3QixJQUFJQyxHQUFRLEdBQ1ozRyxNQUFLdUYsS0FBS04sU0FBU0MsS0FBTzBCLEtBQUtDLFNBQVcsSUFBUUYsR0FBU0MsS0FBS0MsU0FBVyxJQUFRRixHQUFTQyxLQUFLQyxTQUFXLElBQVFGLEdBRXBIM0csS0FBS2tHLE9BQVMsR0FBSXhGLE9BQU1vRyxTQUN4QjlHLEtBQUtrRyxPQUFPeEIsSUFBSzFFLEtBQUt1RixNQWpFMUIsR0FBSU0sS0FJSjNKLEdBQUkrSixjQUFnQixHQUFJdkYsT0FBTW9HLFNBQzlCNUssRUFBSThFLE1BQU0wRCxJQUFLeEksRUFBSStKLGVBQ25CL0osRUFBSW9FLG9CQUFvQnFFLEtBQU0sV0FDMUJ6SSxFQUFJK0osY0FBY3JCLFNBQVUsSUFFaEMxSSxFQUFJcUUscUJBQXFCb0UsS0FBTSxXQUMzQnpJLEVBQUkrSixjQUFjckIsU0FBVSxHQUtoQyxJQUFJbUMsR0FBUyxHQUFJckcsT0FBTXNHLFNBQ3ZCRCxHQUFPRSxLQUFNLHNCQUF1QjVCLEdBMkJwQzFDLEVBQWdCekcsRUFBSyxTQUFXb0gsRUFBU1QsR0FDckNnRCxFQUFVdEMsUUFBUyxTQUFBd0MsR0ZGZixNRUUyQkEsR0FBU21CLE9BQVE1RCxFQUFTVCxPQXlCN0RtRCxFQUFTUSxTQUFXLEdBQUk5RixPQUFNeUcsbUJBQ3hDdkQsTUFBTyxTQUNQd0QsVUFBVyxFQUNYQyxTQUFVLFNBQ1ZDLE9BQVFwTCxFQUFJZ0gsV0FBV0UsYUFDVG1FLGFBQWMsRUFDZDFELEtBQU1uRCxNQUFNOEcsYUFHaEJ4QixFQUFTVSxhQUFlLElBR3hCVixFQUFTeUIsVUFBVVAsT0FBUyxTQUFXNUQsRUFBU1QsR0FDNUM3QyxLQUFLa0csT0FBTzVCLFNBQVNDLEdBQUssS0FDMUJ2RSxLQUFLa0csT0FBTzVCLFNBQVNFLEdBQUt4RSxLQUFLc0csU0FBVyxHQUMxQ3RHLEtBQUtrRyxPQUFPNUIsU0FBU0csR0FBSyxNQUc5QnBJLEVBQVNILEtBTWpCLFFBQVN3TCxHQUFpQnhMLEdBQ3RCLE1BQU9DLEdBQUVDLFFBQVMsU0FBV0MsRUFBU0MsR0FFbEMsR0FBSXFMLEdBQWtCLEVBQ2xCckUsRUFBVSxHQUViLFFBQVVzRSxHQUFPQyxHQUlkakgsT0FBT2tILHNCQUF1QkYsR0FJOUJ0RSxFQUFVdUUsRUFBcUJGLEVBQy9CQSxFQUFrQkUsRUFJbEIzTCxFQUFJbUUsYUFBYWtELFFBQVMsU0FBQWhFLEdGQXRCLE1FQTRCQSxHQUFJK0QsRUFBU3VFLEtBSTdDM0wsRUFBSWdGLFNBQVM2RyxRQUMzQjdMLEVBQUlnRixTQUFTOEcsT0FBUTlMLEVBQUk4RSxNQUFPOUUsRUFBSXVFLFNBRXZCa0gsR0FFSHRMLEVBQVNILEtBVWpCLFFBQVN5RyxHQUFpQnpHLEVBQUtxRCxHQUMzQnJELEVBQUltRSxhQUFhc0UsS0FBTXBGLEdBSzNCLFFBQVN3QixHQUFvQjdFLEVBQUtxSSxFQUFHQyxFQUFHQyxHQUNwQ3ZJLEVBQUl1RSxPQUFPd0UsU0FBU1YsRUFBSUEsRUFDeEJySSxFQUFJdUUsT0FBT3dFLFNBQVNULEVBQUlBLEVBQ3hCdEksRUFBSXVFLE9BQU93RSxTQUFTUixFQUFJQSxFQWhUNUIsR0FBSTVHLEdBQVUxQixFQUFFOEwsaUJBQWtCekgsRUFDQXFCLEVBQ0FvQixFQUNBUSxFQUNBMkIsRUFDQVAsRUFDQTZDLEVBK1NsQyxRQUNJL0osUUFBU0EsRUFDVEUsUUFBU0EsTURwVWJGLFFBQVUsV0FDVixPQUNJbEIsTUFBT04sRUFBRTBELEtBQXFDLFdBQS9CSyxTQUFTZ0ksU0FBU0MsU0FBd0IsU0FBVyxRQUNyRGpJLFNBQVNnSSxTQUFTRSxLQUNsQixPQUluQnZLLFFBQVUxQixFQUFFOEwsaUJBQWtCaE0sb0JBQ0FvQixlQUNBYSxxQkFFbENuQixHQUFHLFdBQ0NjLFFBQVNGLFdBQ1JLLFFBQVMsU0FBVzlCLEdBQ2pCZSxPQUFRLEtBQU0sa0JBQ2QyRCxPQUFPMUUsSUFBTUEiLCJmaWxlIjoiYWxsLmpzIiwic291cmNlc0NvbnRlbnQiOltudWxsLCIvKiBqc2hpbnQgZXNuZXh0OiB0cnVlICovXG5cbi8vIE1haW4uanNcbi8vID09PT09PT1cbi8vIEVudHJ5IHBvaW50IG9mIHRoZSBhcHBsaWNhdGlvbi5cblxuLy8gTWFrZSAmIEluaXRcbi8vID09PT09PT09PT09XG5cbnZhciBtYWtlQXBwID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHdzVXJsOiBXLmpvaW4oIGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6JyA/ICd3c3M6Ly8nIDogJ3dzOi8vJyxcbiAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQubG9jYXRpb24uaG9zdCwgLy9kb2N1bWVudC4nLy8vJy8vJ3dzczovLzE5Mi4xNjguMC43OjcwODAnXG4gICAgICAgICAgICAgICAgICAgICAgICcvJyApXG4gICAgfTtcbn07XG5cbnZhciBpbml0QXBwID0gVy5jb21wb3NlUHJvbWlzZXJzKCBtYWtlV2ViU29ja2V0Q2xpZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VQdW50ZXJWaXpzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VSZXN0UmFkaW9CdXR0b25zICk7XG5cbiQoIGZ1bmN0aW9uICgpIHtcbiAgICBpbml0QXBwKCBtYWtlQXBwKCkgKVxuICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAoIGFwcCApIHtcbiAgICAgICAgcmVwb3J0KCAnT0snLCAnVGhlV29ya2Vycy5uZXQnICk7XG4gICAgICAgIHdpbmRvdy5hcHAgPSBhcHA7XG4gICAgfSk7XG59KTtcblxuLy8gUHJvbWlzZXJzXG4vLyA9PT09PT09PT1cblxuZnVuY3Rpb24gbWFrZVdlYlNvY2tldENsaWVudCAoIGFwcCApIHtcbiAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgY29uc29sZS5sb2coICdDb25uZWN0aW5nIHRvIHdlYnNvY2tldCBjbGllbnQ6JywgYXBwLndzVXJsICk7XG4gICAgICAgIFxuICAgICAgICBhcHAud3NDbGllbnQgPSBuZXcgVy5KU09OU29ja2V0Q29ubmVjdGlvbih7XG4gICAgICAgICAgICBzb2NrZXRVcmw6IGFwcC53c1VybFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXNvbHZlT25GaXJzdENvbm5lY3QgPSBvbmNlKCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKCAnW2RhdGEtZGlzY29ubmVjdGVkLXdhcm5pbmddJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgcmVwb3J0KCAnQ09OTkVDVEVEJywgJ3RvOicsIGFwcC53c1VybCApO1xuICAgICAgICAgICAgcmVzb2x2ZSggYXBwICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGFwcC53c0NsaWVudC5vbiggJ29wZW4nLCByZXNvbHZlT25GaXJzdENvbm5lY3QgKTtcbiAgICAgICAgYXBwLndzQ2xpZW50Lm9uKCAnZXJyb3InLCBtYWtlUmVwb3J0ZXIoICdXZWIgU29ja2V0IEVycm9yJyApICk7XG4gICAgICAgIGFwcC53c0NsaWVudC5vbiggJ2Nsb3NlJywgbWFrZVJlcG9ydGVyKCAnV2ViIFNvY2tldCBDbG9zZScgKSApO1xuICAgICAgICBhcHAud3NDbGllbnQub3BlblNvY2tldENvbm5lY3Rpb24oKTtcbiAgICAgICAgXG4gICAgfSk7XG59XG5cbi8vIFB1bnRlciBWaXpcbi8vIC0tLS0tLS0tLS1cblxuZnVuY3Rpb24gbWFrZVB1bnRlclZpenMgKCBhcHAgKSB7XG4gICAgcmV0dXJuIFcucHJvbWlzZSggZnVuY3Rpb24gKCByZXNvbHZlLCByZWplY3QgKSB7XG4gICAgICAgICQoIFwiW2RhdGEtcHVudGVyLXZpel1cIiApXG4gICAgICAgICAgICAudG9BcnJheSgpXG4gICAgICAgICAgICAubWFwKCBmdW5jdGlvbiAoIGVsICkge1xuICAgICAgICAgICAgICAgIC8vIE1ha2UgdGhlIHB1bnRlciBhcHBsaWNhdGlvblxuICAgICAgICAgICAgICAgIGFwcC5wdW50ZXJWaXogPSBQdW50ZXJWaXoubWFrZUFwcCgpO1xuICAgICAgICAgICAgICAgIC8vIEFkZCBvdXQgZG9tIGVsZW1lbnRcbiAgICAgICAgICAgICAgICBhcHAucHVudGVyVml6LmNvbnRhaW5lckVsID0gZWw7XG5cbiAgICAgICAgICAgICAgICAvLyBJbml0YWlsaXNlIGl0XG4gICAgICAgICAgICAgICAgUHVudGVyVml6XG4gICAgICAgICAgICAgICAgICAgIC5pbml0QXBwKCBhcHAucHVudGVyVml6IClcbiAgICAgICAgICAgICAgICAgICAgLmVycm9yKCBmdW5jdGlvbiAoIGVyciApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoICdGYWlsZWQgdG8gY3JlYXRlIFB1bnRlciBhcHAnLCBlcnIgKTtcbiAgICAgICAgICAgICAgICAgICAgfSkgXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAoIGluaXRhbGlzZWRQdW50ZXJBcHAgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ1B1bnRlciBhcHBsaWNhdGlvbiBtYWRlJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgIH0pO1xufVxuXG4vLyBqUXVlcnkgTW9iaWxlIFVpIEJpbmRpbmdzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmZ1bmN0aW9uIG1ha2VSZXN0UmFkaW9CdXR0b25zICggYXBwICkge1xuICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAvLyBSYWRpbyBCdXR0b25zXG4gICAgICAgIC8vID09PT09PT09PT09PT1cbiAgICAgICAgJCggJ1tkYXRhLXJlc3QtdHlwZT1cInJhZGlvLXBvc3RcIl0nIClcbiAgICAgICAgICAgIC50b0FycmF5KClcbiAgICAgICAgICAgIC5tYXAoICQgKVxuICAgICAgICAgICAgLm1hcCggZnVuY3Rpb24gKCAkZWwgKSB7XG4gICAgICAgICAgICAgICAgLy8gRGlzYWJsZSByZWFsIGV2ZW50c1xuICAgICAgICAgICAgICAgIHZhciAkd3JhcHBlckVsID0gJGVsLnBhcmVudCgpO1xuICAgICAgICAgICAgICAgICR3cmFwcGVyRWwub24oICdjbGljayB0b3VjaGVuZCcsIGZ1bmN0aW9uICggZSApIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ3NlbmRpbmcnLCRlbC52YWwoKSwgJ3RvJywgJGVsLmRhdGEoICdyZXN0VXJpJyApICApO1xuICAgICAgICAgICAgICAgICAgICBSZXN0ZXNxdWVVdGlsLnBvc3QoIGFwcC53c0NsaWVudCwgJGVsLmRhdGEoICdyZXN0VXJpJyApLCAkZWwudmFsKCkgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gUmFkaW8gRmllbGQgU2V0c1xuICAgICAgICAvLyA9PT09PT09PT09PT09PT09XG4gICAgICAgICQoICdbZGF0YS1yZXN0LXR5cGU9XCJmZWlsZHNldFwiXScgKVxuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLm1hcCggJCApXG4gICAgICAgICAgICAubWFwKCBmdW5jdGlvbiAoICRlbCApIHtcblxuICAgICAgICAgICAgICAgIHZhciByYWRpb0VscyA9ICRlbC5maW5kKCAnaW5wdXRbdHlwZT1cInJhZGlvXCJdJyApLmNoZWNrYm94cmFkaW8oKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggICdnb3QgYSBmaWVsZCBzZXQnLCAkZWwuZGF0YSggJ3Jlc3RVcmknICkgKTtcbiAgICAgICAgICAgICAgICBSZXN0ZXNxdWVVdGlsLnN1YnNjcmliZVdpdGhJbml0aWFsR2V0KCBhcHAud3NDbGllbnQsICRlbC5kYXRhKCAncmVzdFVyaScgKSwgZnVuY3Rpb24gKCBwYWNrZXQgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJhZGlvRWxzXG4gICAgICAgICAgICAgICAgICAgICAgICAucHJvcCggJ2NoZWNrZWQnLCBmYWxzZSApXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2hlY2tib3hyYWRpbyggJ3JlZnJlc2gnIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoICdpbnB1dFt2YWx1ZT1cIicrIHBhY2tldC5nZXRCb2R5KCkgKydcIl0nIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCAnY2hlY2tlZCcsICdjaGVja2VkJyApXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2hlY2tib3hyYWRpbyggJ3JlZnJlc2gnIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wYXJlbnQoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoICdsYWJlbCcgKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCAndWktcmFkaW8tb2ZmJyApXG4gICAgICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoICd1aS1yYWRpby1vbicgKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgcmVzb2x2ZSggYXBwICk7XG4gICAgfSk7XG59XG5cbi8vIFV0aWxzXG4vLyA9PT09PVxuXG4vLyBGdW5jdGlvblxuLy8gLS0tLS0tLS1cbiAgICBcbmZ1bmN0aW9uIG9uY2UgKCBmbiApIHtcbiAgICB2YXIgaGFzVHJpZ2dlcmVkID0gZmFsc2U7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCAhIGhhc1RyaWdnZXJlZCApIHtcbiAgICAgICAgICAgIGZuKCk7XG4gICAgICAgICAgICBoYXNUcmlnZ2VyZWQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfTtcbn1cblxuLy8gUmVwb3J0aW5nXG4vLyAtLS0tLS0tLS1cblxuZnVuY3Rpb24gcmVwb3J0KCBzdGF0dXMsIHN0ciApIHtcbiAgICBjb25zb2xlLmxvZyggJ1snLCBzdGF0dXMsICddJywgVy5yZXN0KCBXLnRvQXJyYXkoIGFyZ3VtZW50cyApICkuam9pbiggJyAnICkgKTtcbn1cblxuZnVuY3Rpb24gbWFrZVJlcG9ydGVyKCBzdGF0dXMsIHN0ciApIHtcbiAgICB2YXIgcmVwb3J0QXJncyA9IGFyZ3VtZW50cztcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXBvcnQuYXBwbHkoIHRoaXMsIHJlcG9ydEFyZ3MgKTtcbiAgICAgICAgdmFyIGNhbGxlZUFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAgICAgcmVzb2x2ZS5hcHBseSggdGhpcywgY2FsbGVlQXJncyApO1xuICAgICAgICB9KTtcbiAgICB9O1xufVxuIiwiLyoganNoaW50IGVzbmV4dDogdHJ1ZSAqL1xuXG4vLyBQdW50ZXIgVml6XG4vLyA9PT09PT09PT09XG4vLyBBIHRocmVlLmpzIHZpc3VsaXNhdGlvbiB0byBiZVxuLy8gcnVuIG9uIGFuIEhUQyBwaG9uZSBhbmQgY2FycmllZCBieVxuLy8gcHVudGVycyBpbnRvIHRoZSBtaXJyb3IgYm94LlxuXG52YXIgUHVudGVyVml6ID0gKGZ1bmN0aW9uICgpIHtcblxuICAgIC8vIEluaXQgJiBtYWtlXG4gICAgLy8gPT09PT09PT09PT1cbiAgICBmdW5jdGlvbiBtYWtlQXBwICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbnRhaW5lckVsOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApLFxuICAgICAgICAgICAgYmFja3JvdW5kQ29sb3I6IDB4NjE2MjY0LFxuICAgICAgICAgICAgcHJlUmVuZGVyRm5zOiBbXSxcbiAgICAgICAgICAgIHByZUN1YmVDYW1SZW5kZXJGbnM6IFtdLFxuICAgICAgICAgICAgcG9zdEN1YmVDYW1SZW5kZXJGbnM6IFtdXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgdmFyIGluaXRBcHAgPSBXLmNvbXBvc2VQcm9taXNlcnMoIG1ha2VDYW1lcmFTY2VuZVJlbmRlcmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlV2ViQ2FtVGV4dHVyZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZUN1YmVDYW0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VXZWJDYW1Cb3hNZXNoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU3dhcm0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VMaWdodHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VSZW5kZXJMb29wICk7XG5cbiAgICAvLyBQcm9taXNlcnNcbiAgICAvLyA9PT09PT09PT1cblxuICAgIC8vIENhbWVyYSwgU2NlbmUsIFJlbmRlcmVyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICBmdW5jdGlvbiBtYWtlQ2FtZXJhU2NlbmVSZW5kZXJlciAoIGFwcCApIHtcbiAgICAgICAgcmV0dXJuIFcucHJvbWlzZSggZnVuY3Rpb24gKCByZXNvbHZlLCByZWplY3QgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIENhbWVyYVxuICAgICAgICAgICAgLy8gLS0tLS0tXG4gICAgICAgICAgICBhcHAuY2FtZXJhID0gbmV3IFRIUkVFLlBlcnNwZWN0aXZlQ2FtZXJhKCA3MCwgd2luZG93LmlubmVyV2lkdGggLyB3aW5kb3cuaW5uZXJIZWlnaHQsIDEsIDMwMDAgKTtcbiAgICAgICAgICAgIHNldENhbWVyYVBvc2l0aW9uKCBhcHAsIDAsIDAsIDIwMCApO1xuXG4gICAgICAgICAgICAvLyBTY2VuZVxuICAgICAgICAgICAgLy8gLS0tLS1cbiAgICAgICAgICAgIGFwcC5zY2VuZSA9IG5ldyBUSFJFRS5TY2VuZSgpO1xuXG4gICAgICAgICAgICAvLyBSZW5kZXJlclxuICAgICAgICAgICAgLy8gLS0tLS0tLS1cbiAgICAgICAgICAgIGFwcC5yZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKCB7IGFudGlhbGlhczogZmFsc2UgfSApO1xuXHQgICAgYXBwLnJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICk7XG5cdCAgICBhcHAucmVuZGVyZXIuc2V0U2l6ZSggd2luZG93LmlubmVyV2lkdGgsIHdpbmRvdy5pbm5lckhlaWdodCApO1xuICAgICAgICAgICAgYXBwLnJlbmRlcmVyLnNldENsZWFyQ29sb3IoIGFwcC5iYWNrZ3JvdW5kQ29sb3IgKTtcblx0ICAgIGFwcC5yZW5kZXJlci5zb3J0T2JqZWN0cyA9IGZhbHNlO1xuXG4gICAgICAgICAgICBhcHAuY29udGFpbmVyRWwuYXBwZW5kQ2hpbGQoIGFwcC5yZW5kZXJlci5kb21FbGVtZW50ICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXZWIgQ2FtXG4gICAgLy8gLS0tLS0tLVxuICAgIC8vIE1ha2UgdGhlIHdlYiBjYW0gYXZhaWxhYmxlIGFzIGEgdGV4dHVyZVxuICAgIGZ1bmN0aW9uIG1ha2VXZWJDYW1UZXh0dXJlICggYXBwICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcblxuICAgICAgICAgICAgLy8gV2ViIENhbSBET00gRWxlbWVudFxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgdmFyIHdlYkNhbUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKTtcbiAgICAgICAgICAgIHdlYkNhbUVsLmF1dG9wbGF5ID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy8gV2ViIENhbSBTdHJlYW1cbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKCB7IHZpZGVvOnRydWUgfSwgZnVuY3Rpb24oIHN0cmVhbSApe1xuICAgICAgICAgICAgICAgIHdlYkNhbUVsLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoIHN0cmVhbSApO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oIGVyciApe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGdldCBhIHN0cmVhbSBkdWUgdG9cIiwgZXJyKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBXZWIgQ2FtIFRleHR1cmVcbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgYXBwLndlYkNhbVRleHR1cmUgPSBuZXcgVEhSRUUuVGV4dHVyZSggd2ViQ2FtRWwgKTtcbiAgICAgICAgICAgIGFwcC53ZWJDYW1UZXh0dXJlLm1pbkZpbHRlciA9IFRIUkVFLkxpbmVhckZpbHRlcjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVuZGVyIFVwZGF0ZXNcbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBhZGRQcmVSZW5kZXJGbiggYXBwLCBmdW5jdGlvbiAoIGRldGxhTVMsIHRpbWVzdGFtcE1TICkge1xuICAgICAgICAgICAgICAgIGlmKCB3ZWJDYW1FbC5yZWFkeVN0YXRlID09PSB3ZWJDYW1FbC5IQVZFX0VOT1VHSF9EQVRBICl7XG4gICAgICAgICAgICAgICAgICAgIGFwcC53ZWJDYW1UZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVzb2x2ZSggYXBwICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEN1YmUgQ2FtZXJhXG4gICAgLy8gLS0tLS0tLS0tLS1cbiAgICAvLyBDcmVhdGUgYSBjdWJlIGNhbSBmb3IgYSBkeW5hbWljIGVudk1hcC5cbiAgICAvLyBUaGlzIGFsc28gZW5hYmxlcyB0d28gaG9va3M6IGBwcmVDdWJlQ2FtUmVuZGVyQWN0aW9uc2AgJiBgcG9zdEN1YmVDYW1SZW5kZXJBY3Rpb25zYFxuICAgIC8vIGluIHRoZSBhcHAgZm9yIHRoYXQgb2JqZWN0M0QgaW4gdGhlIHNjZW5lIGNhbiBiZSB0dXJuZWQgb24gYW5kIG9mZiBkdXJpbmdcbiAgICAvLyB0aGUgd2ViY2FtcyByZW5kZXJcbiAgICBmdW5jdGlvbiBtYWtlQ3ViZUNhbSAoIGFwcCApIHsgXG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuXG4gICAgICAgICAgICBhcHAuY3ViZUNhbWVyYSA9IG5ldyBUSFJFRS5DdWJlQ2FtZXJhKDEsIDMwMDAsIDI1Nik7IC8vIG5lYXIsIGZhciwgcmVzb2x1dGlvblxuICAgICAgICAgICAgYXBwLmN1YmVDYW1lcmEucmVuZGVyVGFyZ2V0Lm1pbkZpbHRlciA9IFRIUkVFLkxpbmVhck1pcE1hcExpbmVhckZpbHRlcjsgLy8gbWlwbWFwIGZpbHRlclxuICAgICAgICAgICAgXG4gICAgICAgICAgICBhZGRQcmVSZW5kZXJGbiggYXBwLCBmdW5jdGlvbiAoIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkgeyAgICBcbiAgICAgICAgICAgICAgICAvLyBSZW5kZXIgdGhlIGN1YmUgY2FtZXJhIHRvIGN1YmUgbWFwXG4gICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgIGFwcC5wcmVDdWJlQ2FtUmVuZGVyRm5zLmZvckVhY2goIGZuID0+IGZuKCBkZWx0YU1TLCB0aW1lc3RhbXBNUyApICk7XG4gICAgICAgICAgICAgICAgYXBwLmN1YmVDYW1lcmEudXBkYXRlQ3ViZU1hcCggYXBwLnJlbmRlcmVyLCBhcHAuc2NlbmUgKTtcbiAgICAgICAgICAgICAgICBhcHAucG9zdEN1YmVDYW1SZW5kZXJGbnMuZm9yRWFjaCggZm4gPT4gZm4oIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXNvbHZlKCBhcHAgKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2ViIENhbSBCb3ggTWVzaFxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBDcmVhdGVzIGEgYm94IHdpdGggdGhlIHdlYiBjYW0gZGlzcGxheWVkXG4gICAgLy8gb24gdGhlIGluc2lkZSBvZiBlYWNoIG9mIGl0J3MgNiBzaWRlc1xuICAgIGZ1bmN0aW9uIG1ha2VXZWJDYW1Cb3hNZXNoICggYXBwICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHdlYkNhbUJveE1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcbiAgICAgICAgICAgICAgICBtYXA6IGFwcC53ZWJDYW1UZXh0dXJlLFxuICAgICAgICAgICAgICAgIGNvbG9yOiAweGZmZmZmZixcblx0ICAgICAgICBzaWRlOiBUSFJFRS5CYWNrU2lkZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGFwcC53ZWJDYW12Qm94TWVzaCA9IG5ldyBUSFJFRS5NZXNoKCBuZXcgVEhSRUUuQm94R2VvbWV0cnkoIDIwMDAsIDIwMDAsIDIwMDAgKSwgd2ViQ2FtQm94TWF0ZXJpYWwgKTtcblxuICAgICAgICAgICAgdmFyIHJvdGF0aW9uWCA9IFcucmFuZG9tQmV0d2VlbiggMC4wMDAyLCAwLjAwMDAyICk7XG4gICAgICAgICAgICB2YXIgcm90YXRpb25ZID0gVy5yYW5kb21CZXR3ZWVuKCAwLjAwMDIsIDAuMDAwMDIgKTtcbiAgICAgICAgICAgIHZhciByb3RhdGlvblogPSBXLnJhbmRvbUJldHdlZW4oIDAuMDAwMiwgMC4wMDAwMiApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiB3ZSB3YW50IHRvIHJvdGF0ZSBpdFxuICAgICAgICAgICAgYWRkUHJlUmVuZGVyRm4oIGFwcCwgZnVuY3Rpb24gKCBkZWx0YU1TLCB0aW1lc3RhbXBNUyApIHtcbiAgICAgICAgICAgICAgICBhcHAud2ViQ2FtdkJveE1lc2gucm90YXRpb24ueCArPSAoIGRlbHRhTVMgKiByb3RhdGlvblggKTtcbiAgICAgICAgICAgICAgICBhcHAud2ViQ2FtdkJveE1lc2gucm90YXRpb24ueSArPSAoIGRlbHRhTVMgKiByb3RhdGlvblkgKTtcbiAgICAgICAgICAgICAgICBhcHAud2ViQ2FtdkJveE1lc2gucm90YXRpb24ueiArPSAoIGRlbHRhTVMgKiByb3RhdGlvblogKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG5cdCAgICBhcHAuc2NlbmUuYWRkKCBhcHAud2ViQ2FtdkJveE1lc2ggKTtcblxuICAgICAgICAgICAgLy8gU2hvdyBpdCBvbmx5IGZvciB0aGUgY3ViZSBjYW1cbiAgICAgICAgICAgIGFwcC5wcmVDdWJlQ2FtUmVuZGVyRm5zLnB1c2goIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBhcHAud2ViQ2FtdkJveE1lc2gudmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYXBwLnBvc3RDdWJlQ2FtUmVuZGVyRm5zLnB1c2goIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBhcHAud2ViQ2FtdkJveE1lc2gudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIFxuXG4gICAgICAgICAgICByZXNvbHZlKCBhcHAgKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gTGlnaHRzXG4gICAgLy8gLS0tLS0tXG4gICAgZnVuY3Rpb24gbWFrZUxpZ2h0cyAoIGFwcCApIHtcbiAgICAgICAgcmV0dXJuIFcucHJvbWlzZSggZnVuY3Rpb24gKCByZXNvbHZlLCByZWplY3QgKSB7XG4gICAgICAgICAgICBhcHAuc2NlbmUuYWRkKCBuZXcgVEhSRUUuQW1iaWVudExpZ2h0KCAweDIyMjIyMiApICk7XG5cbiAgICAgICAgICAgIHZhciBkaXJlY3Rpb25hbExpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoIDB4ZmZmZmZmLCAyICk7XG5cdCAgICBkaXJlY3Rpb25hbExpZ2h0LnBvc2l0aW9uLnNldCggMiwgMS4yLCAxMCApLm5vcm1hbGl6ZSgpO1xuXHQgICAgYXBwLnNjZW5lLmFkZCggZGlyZWN0aW9uYWxMaWdodCApO1xuXG5cdCAgICBkaXJlY3Rpb25hbExpZ2h0ID0gbmV3IFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQoIDB4ZmZmZmZmLCAxICk7XG5cdCAgICBkaXJlY3Rpb25hbExpZ2h0LnBvc2l0aW9uLnNldCggLTIsIDEuMiwgLTEwICkubm9ybWFsaXplKCk7XG5cdCAgICBhcHAuc2NlbmUuYWRkKCBkaXJlY3Rpb25hbExpZ2h0ICk7ICBcbiAgICAgICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBTd2FybVxuICAgIC8vIC0tLS0tXG4gICAgZnVuY3Rpb24gbWFrZVN3YXJtICggYXBwICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIHBhcnRpY2xlcyA9IFtdO1xuXG4gICAgICAgICAgICAvLyBBZGQgdG8gU2NlbmVcbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgYXBwLnN3YXJtT2JqZWN0M0QgPSBuZXcgVEhSRUUuT2JqZWN0M0QoKTtcbiAgICAgICAgICAgIGFwcC5zY2VuZS5hZGQoIGFwcC5zd2FybU9iamVjdDNEICk7XG4gICAgICAgICAgICBhcHAucHJlQ3ViZUNhbVJlbmRlckZucy5wdXNoKCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXBwLnN3YXJtT2JqZWN0M0QudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBhcHAucG9zdEN1YmVDYW1SZW5kZXJGbnMucHVzaCggZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGFwcC5zd2FybU9iamVjdDNELnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIExvYWRlclxuICAgICAgICAgICAgLy8gLS0tLS0tXG4gICAgICAgICAgICB2YXIgbG9hZGVyID0gbmV3IFRIUkVFLk9CSkxvYWRlcigpO1xuICAgICAgICAgICAgbG9hZGVyLmxvYWQoICcvb2JqL3BpbGxvdy1ib3gub2JqJywgb25PYmpMb2FkZWQgKTtcblxuICAgICAgICAgICAgLy8gU3dhcm0gQ3JlYXRpb25cbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uT2JqTG9hZGVkICggb2JqICkge1xuXG4gICAgICAgICAgICAgICAgdmFyIG1lc2ggPSBvYmouY2hpbGRyZW5bIDAgXTtcblxuICAgICAgICAgICAgICAgIC8vIFBhcnRpY2xlIENyZWF0aW9uXG4gICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgICAvLyBFYXNlIGluIHRoZSBjcmVhdGlvbiBvZiB0aGUgcGFydGljbGVzXG4gICAgICAgICAgICAgICAgdmFyIG1heFBhcnRpY2xlcyA9IDEwMDtcbiAgICAgICAgICAgICAgICB2YXIgbWluQ3JlYXRpb25UaW1lID0gNTtcbiAgICAgICAgICAgICAgICB2YXIgbWF4Q3JlYXRpb25UaW1lTVMgPSAxMDA7XG5cbiAgICAgICAgICAgICAgICB2YXIgbWF0ZXJpYWwgPSBcbiAgICAgICAgICAgICAgICAoZnVuY3Rpb24gY3JlYXRlTW9yZSAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggcGFydGljbGVzLmxlbmd0aCA8IG1heFBhcnRpY2xlcyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0aWNsZSA9IG5ldyBQYXJ0aWNsZSggbWVzaCApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBwLnN3YXJtT2JqZWN0M0QuYWRkKCBwYXJ0aWNsZS5hbmNob3IgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhcnRpY2xlcy5wdXNoKCBwYXJ0aWNsZSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCggY3JlYXRlTW9yZSwgVy5tYXAoIHBhcnRpY2xlcy5sZW5ndGggLyBtYXhQYXJ0aWNsZXMsIDAsIDEsIG1heENyZWF0aW9uVGltZU1TLCBtaW5DcmVhdGlvblRpbWUsIFcuaW50ZXJwb2xhdGlvbnMuZWFzZUluICkgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0oKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFVwZGF0aW5nXG4gICAgICAgICAgICBhZGRQcmVSZW5kZXJGbiggYXBwLCBmdW5jdGlvbiAoIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkge1xuICAgICAgICAgICAgICAgIHBhcnRpY2xlcy5mb3JFYWNoKCBwYXJ0aWNsZSA9PiBwYXJ0aWNsZS51cGRhdGUoIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkgKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBQYXJ0aWNsZSBDbGFzc1xuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgIGZ1bmN0aW9uIFBhcnRpY2xlICggbWVzaCApIHtcblxuICAgICAgICAgICAgICAgIHRoaXMudmVsb2NpdHkgPSBXLnJhbmRvbUJldHdlZW4oIDAuMiwgMSApO1xuXG4gICAgICAgICAgICAgICAgLy8gTWVzaFxuICAgICAgICAgICAgICAgIHRoaXMubWVzaCA9IG1lc2guY2xvbmUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1lc2gubWF0ZXJpYWwgPSBQYXJ0aWNsZS5tYXRlcmlhbC5jbG9uZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC5zY2FsZS54ID0gUGFydGljbGUuaW5pdGlhbFNjYWxlO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC5zY2FsZS55ID0gUGFydGljbGUuaW5pdGlhbFNjYWxlO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC5zY2FsZS56ID0gUGFydGljbGUuaW5pdGlhbFNjYWxlO1xuXG4gICAgICAgICAgICAgICAgLy8gUG9zaXRpb25cbiAgICAgICAgICAgICAgICB2YXIgcmFuZ2UgPSAxMDA7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLnBvc2l0aW9uLnNldCggKCBNYXRoLnJhbmRvbSgpIC0gMC41ICkgKiByYW5nZSwgKCBNYXRoLnJhbmRvbSgpIC0gMC41ICkgKiByYW5nZSwgKCBNYXRoLnJhbmRvbSgpIC0gMC41ICkgKiByYW5nZSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLmFuY2hvciA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYW5jaG9yLmFkZCggdGhpcy5tZXNoICk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vICMjIyBTdGF0aWNcbiAgICAgICAgICAgIFBhcnRpY2xlLm1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hQaG9uZ01hdGVyaWFsKCB7XG5cdFx0Y29sb3I6IDB4ZmZmZmZmLFxuXHRcdHNoaW5pbmVzczogMC4wLFxuXHRcdHNwZWN1bGFyOiAweGZmZmZmZixcblx0XHRlbnZNYXA6IGFwcC5jdWJlQ2FtZXJhLnJlbmRlclRhcmdldCxcbiAgICAgICAgICAgICAgICByZWZsZWN0aXZpdHk6IDEuMCxcbiAgICAgICAgICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgUGFydGljbGUuaW5pdGlhbFNjYWxlID0gMjAwO1xuXG4gICAgICAgICAgICAvLyAjIyMgTWV0aG9kXG4gICAgICAgICAgICBQYXJ0aWNsZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCBkZWx0YU1TLCB0aW1lc3RhbXBNUyApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFuY2hvci5yb3RhdGlvbi54ICs9IDAuMDAyO1xuICAgICAgICAgICAgICAgIHRoaXMuYW5jaG9yLnJvdGF0aW9uLnkgKz0gdGhpcy52ZWxvY2l0eSAvIDEwO1xuICAgICAgICAgICAgICAgIHRoaXMuYW5jaG9yLnJvdGF0aW9uLnogKz0gMC4wMDE7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXNvbHZlKCBhcHAgKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUmVuZGVyIExvb3BcbiAgICAvLyAtLS0tLS0tLS0tLVxuICAgIGZ1bmN0aW9uIG1ha2VSZW5kZXJMb29wICggYXBwICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcblxuICAgICAgICAgICAgdmFyIGxhc3RUaW1lc3RhbXBNUyA9IDA7XG4gICAgICAgICAgICB2YXIgZGVsdGFNUyA9IDA7XG5cbiAgICAgICAgICAgIChmdW5jdGlvbiAgbG9vcCAoIGN1cnJlbnRUaW1lc3RhbXBNUyApIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZWN1clxuICAgICAgICAgICAgICAgIC8vIC0tLS0tXG4gICAgICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSggbG9vcCApO1xuXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRpbWVzdGFtcHNcbiAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgICBkZWx0YU1TID0gY3VycmVudFRpbWVzdGFtcE1TIC0gbGFzdFRpbWVzdGFtcE1TO1xuICAgICAgICAgICAgICAgIGxhc3RUaW1lc3RhbXBNUyA9IGN1cnJlbnRUaW1lc3RhbXBNUztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBBY3Rpb25hYmxlc1xuICAgICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgYXBwLnByZVJlbmRlckZucy5mb3JFYWNoKCBmbiA9PiBmbiggZGVsdGFNUywgY3VycmVudFRpbWVzdGFtcE1TICkgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZW5kZXJcbiAgICAgICAgICAgICAgICAvLyAtLS0tLS1cbiAgICAgICAgICAgICAgICBhcHAucmVuZGVyZXIuY2xlYXIoKTtcblx0XHRhcHAucmVuZGVyZXIucmVuZGVyKCBhcHAuc2NlbmUsIGFwcC5jYW1lcmEgKTtcblxuICAgICAgICAgICAgfSggbGFzdFRpbWVzdGFtcE1TICkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXNvbHZlKCBhcHAgKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICAvLyBVdGlsc1xuICAgIC8vID09PT09XG5cbiAgICAvLyBSZW5kZXIgTG9vcFxuICAgIC8vIC0tLS0tLS0tLS0tXG4gICAgZnVuY3Rpb24gYWRkUHJlUmVuZGVyRm4gKCBhcHAsIGZuICkge1xuICAgICAgICBhcHAucHJlUmVuZGVyRm5zLnB1c2goIGZuICk7XG4gICAgfVxuXG4gICAgLy8gQ2FtZXJhXG4gICAgLy8gLS0tLS0tXG4gICAgZnVuY3Rpb24gc2V0Q2FtZXJhUG9zaXRpb24gKCBhcHAsIHgsIHksIHogKSB7XG4gICAgICAgIGFwcC5jYW1lcmEucG9zaXRpb24ueCA9IHg7XG4gICAgICAgIGFwcC5jYW1lcmEucG9zaXRpb24ueSA9IHk7XG4gICAgICAgIGFwcC5jYW1lcmEucG9zaXRpb24ueiA9IHo7XG4gICAgfVxuIFxuICAgIC8vIEV4cG9ydFxuICAgIC8vID09PT09PSAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBtYWtlQXBwOiBtYWtlQXBwLFxuICAgICAgICBpbml0QXBwOiBpbml0QXBwICBcbiAgICB9O1xuICAgIFxufSgpKTtcblxuXG5cblxuXG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==