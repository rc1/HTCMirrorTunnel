"use strict";function makeWebSocketClient(e){return W.promise(function(t,n){console.log("Connecting to websocket client:",e.wsUrl),e.wsClient=new W.JSONSocketConnection({socketUrl:e.wsUrl});var o=once(function(){$("[data-disconnected-warning]").remove(),report("CONNECTED","to:",e.wsUrl),t(e)});e.wsClient.on("open",o),e.wsClient.on("error",makeReporter("Web Socket Error")),e.wsClient.on("close",makeReporter("Web Socket Close")),e.wsClient.openSocketConnection()})}function addPunterCid(e){return W.promise(function(t,n){e.punterCid=$("[data-punter-cid]").data("punterCid"),t(e)})}function makePunterVizs(e){return W.promise(function(t,n){$("[data-punter-viz]").toArray().map(function(t){e.punterViz=PunterViz.makeViz(),e.punterViz.containerEl=t,e.punterViz.wsClient=e.wsClient;PunterViz.initViz(e.punterViz).error(function(e){console.error("Failed to create Punter app",e)}).success(function(t){if(window.location.search.indexOf("debug")>-1){var n=document.createElement("input");n.setAttribute("type","range"),n.setAttribute("min",-1),n.setAttribute("max",1),n.setAttribute("step",.01),n.setAttribute("value",.25),n.setAttribute("style","position: absolute"),$(n).asEventStream("change").map(function(e){return e.currentTarget}).map(function(e){return $(e).val()}).onValue(function(e){return PunterViz.setVelocity(t,null,e,null)}),$("#punter").prepend(n)}var o=25.714285714,r=$(window).asEventStream("deviceorientation").map(function(e){return[e.originalEvent.gamma,e.originalEvent.alpha,e.originalEvent.beta]}),i=r.map(function(e){return e[0]});r.onValue(function(e){console.log("updating",e),t.deviceRotation=e}),r.throttle(100).onValue(function(e){return PunterViz.setVelocity(t,null,W.map(e[0],-180,180,-1,1,!0),null)}),i.map(function(e){return-o>e?"backward":e>o?"forward":"none"}).skipDuplicates().throttle(100).onValue(function(t){"phone-"+e.punterCid===e.controlMode&&RestesqueUtil.post(e.wsClient,"/motor/rotation/direction/",t)}),i.map(function(e){return Math.abs(e)}).map(function(e){return e>90-o?"high":e>90-2*o?"medium":"low"}).throttle(100).onValue(function(t){"phone-"+e.punterCid===e.controlMode&&RestesqueUtil.post(e.wsClient,"/motor/rotation/speed/",t)}),console.log("Punter application made")})}),t(e)})}function makeRestRadioButtons(e){return W.promise(function(t,n){$('[data-rest-type="radio-post"]').toArray().map($).map(function(t){var n=t.parent();n.on("click touchend",function(n){return n.preventDefault(),console.log("sending",t.val(),"to",t.data("restUri")),RestesqueUtil.post(e.wsClient,t.data("restUri"),t.val()),!1})}),$('[data-rest-type="feildset"]').toArray().map($).map(function(t){function n(){RestesqueUtil.subscribeWithInitialGet(e.wsClient,t.data("restUri"),function(e){o.prop("checked",!1).checkboxradio("refresh").filter('input[value="'+e.getBody()+'"]').attr("checked","checked").checkboxradio("refresh").parent().find("label").removeClass("ui-radio-off").addClass("ui-radio-on")})}var o=t.find('input[type="radio"]').checkboxradio();console.log("Got a field set",t.data("restUri")),n(),e.wsClient.on("open",function(){console.log("Subscribnig:",t.data("restUri")),n()})}),t(e)})}function once(e){var t=!1;return function(){t||(e(),t=!0)}}function report(e,t){console.log("[",e,"]",W.rest(W.toArray(arguments)).join(" "))}function makeReporter(e,t){var n=arguments;return function(){report.apply(this,n);var e=arguments;return W.promise(function(t,n){t.apply(this,e)})}}var PunterViz=function(){function e(){return{containerEl:document.createElement("div"),backroundColor:6382180,velocity:[0,0,0],deviceRotation:[0,0,0],preRenderFns:[],preCubeCamRenderFns:[],postCubeCamRenderFns:[],wsClient:void 0,height:640,width:360,swarmColor:new THREE.Color(16777215),backgroundColor:new THREE.Color(10866508)}}function t(e){return W.promise(function(t,n){function o(){RestesqueUtil.subscribeWithInitialGet(app.wsClient,"/host/control/mode/",function(e){app.controlMode=e.getBody(),console.log("Control Mode Change to:",app.controlMode)})}e.controlMode="",o(),e.wsClient.on("open",o),t(e)})}function n(e){return W.promise(function(t,n){e.camera=new THREE.PerspectiveCamera(70,e.width/e.height,1,3e4),m(e,0,0,200),e.scene=new THREE.Scene,e.scene.fog=new THREE.Fog(0,0,3e4),e.renderer=new THREE.WebGLRenderer({antialias:!1}),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(e.width,e.height),e.renderer.setClearColor(e.backgroundColor),e.renderer.sortObjects=!1,e.containerEl.appendChild(e.renderer.domElement),t(e)})}function o(e){return W.promise(function(t,n){var o=document.createElement("video");o.autoplay=!0,navigator.webkitGetUserMedia({video:!0},function(e){o.src=URL.createObjectURL(e)},function(e){console.log("Failed to get a stream due to",e)}),e.webCamTexture=new THREE.Texture(o),e.webCamTexture.minFilter=THREE.LinearFilter,d(e,function(t,n){o.readyState===o.HAVE_ENOUGH_DATA&&(e.webCamTexture.needsUpdate=!0)}),t(e)})}function r(e){return W.promise(function(t,n){e.cubeCamera=new THREE.CubeCamera(1,3e4,256),e.cubeCamera.renderTarget.minFilter=THREE.LinearMipMapLinearFilter,d(e,function(t,n){e.preCubeCamRenderFns.forEach(function(e){return e(t,n)}),e.cubeCamera.updateCubeMap(e.renderer,e.scene),e.postCubeCamRenderFns.forEach(function(e){return e(t,n)})}),t(e)})}function i(e){return W.promise(function(t,n){e.webCamMaterial=new THREE.MeshBasicMaterial({map:e.webCamTexture,color:16777215,side:THREE.DoubleSide}),t(e)})}function a(e){return W.promise(function(t,n){var o=THREE.ImageUtils.loadTexture("/image/billboard-background.png");o.minFilter=THREE.NearestFilter,o.magFiler=THREE.NearestFilter;var r=new THREE.MeshBasicMaterial({map:o,color:16777215,transparent:!0}),i=new THREE.PlaneBufferGeometry(360,640),a=new THREE.Mesh(i,r);a.translateZ(-250),e.scene.add(a),e.preCubeCamRenderFns.push(function(){a.visible=!1}),e.postCubeCamRenderFns.push(function(){a.visible=!0}),t(e)})}function s(e){return W.promise(function(t,n){function o(n){console.log(n.children[0]),e.webCamHedronMesh=n.children[0].clone(),e.webCamHedronMesh.material=e.webCamMaterial.clone();var o=6e3;e.webCamHedronMesh.scale.set(o,o,o);W.randomBetween(2e-4,2e-5),W.randomBetween(2e-4,2e-5),W.randomBetween(2e-4,2e-5);d(e,function(t,n){e.webCamHedronMesh.rotation.x+=.5*e.velocity[0],e.webCamHedronMesh.rotation.y+=.5*e.velocity[1],e.webCamHedronMesh.rotation.z+=.5*e.velocity[2]}),e.scene.add(e.webCamHedronMesh),e.preCubeCamRenderFns.push(function(){e.webCamHedronMesh.visible=!0,e.webCamHedronMesh.wireframe=!1,e.webCamHedronMesh.material.color.set(16777215)}),e.postCubeCamRenderFns.push(function(){e.webCamHedronMesh.visible=!0,e.webCamHedronMesh.material.color.set(e.backgroundColor)}),t(e)}var r=new THREE.OBJLoader;r.load("/obj/hedron.obj",o)})}function c(e){return W.promise(function(t,n){e.scene.add(new THREE.AmbientLight(2236962));var o=new THREE.DirectionalLight(16777215,2);o.position.set(2,1.2,10).normalize(),e.scene.add(o),o=new THREE.DirectionalLight(16777215,1),o.position.set(-2,1.2,-10).normalize(),e.scene.add(o),t(e)})}function u(e){return W.promise(function(t,n){function o(t){function n(e){return.0174532925*e}this.velocity=[0,0,0],this.mesh=t.clone(),this.anchor=new THREE.Object3D,this.anchor.add(this.mesh),this.mesh.material=o.material.clone(),this.mesh.material.color=e.swarmColor;var r=70;this.mesh.translateX(W.randomBetween(-r,r)),this.mesh.translateY(W.randomBetween(-r,r)),this.mesh.translateZ(W.randomBetween(-r,r)),this.distance=W.map(this.mesh.position.distanceTo(this.anchor.position),0,r,1,.1,!0);var i=250,a=W.interpolations.quarticEaseOut(this.distance);this.mesh.scale.set(a*i/2,a*i/2,a*i);var s=n(180);this.mesh.rotation.x=W.randomBetween(-s,s),this.mesh.rotation.y=W.randomBetween(-s,s),this.mesh.rotation.z=W.randomBetween(-s,s);this.anchor.rotation.x+=W.randomBetween(-n(20),n(20)),this.rotationSpeed=[Math.random(),Math.random(),Math.random()].map(Math.abs)}function r(t){var n=t.children[0],r=120,a=5,s=20;!function c(){if(i.length<r){var t=new o(n);e.swarmObject3D.add(t.anchor),i.push(t),setTimeout(c,W.map(i.length/r,0,1,s,a,W.interpolations.easeIn))}}()}var i=[];e.swarmObject3D=new THREE.Object3D,e.scene.add(e.swarmObject3D),e.preCubeCamRenderFns.push(function(){e.swarmObject3D.visible=!1}),e.postCubeCamRenderFns.push(function(){e.swarmObject3D.visible=!0}),d(e,function(e,t){i.forEach(function(n){return n.update(e,t)})}),o.material=new THREE.MeshPhongMaterial({color:16777215,shininess:0,specular:16777215,envMap:e.cubeCamera.renderTarget,reflectivity:1,side:THREE.DoubleSide}),o.prototype.update=function(t,n){this.velocity[0]+=(e.velocity[0]-this.velocity[0])*(1-this.distance)*.05,this.velocity[1]+=(e.velocity[1]-this.velocity[1])*(1-this.distance)*.05,this.velocity[2]+=(e.velocity[2]-this.velocity[2])*(1-this.distance)*.05,this.anchor.rotation.x+=.4*this.velocity[0],this.anchor.rotation.y+=.4*this.velocity[1],this.anchor.rotation.z+=.4*this.velocity[2];Math.max(this.velocity[0],this.velocity[1],this.velocity[2]);this.mesh.rotation.x+=.01*this.rotationSpeed[0],this.mesh.rotation.y+=.01*this.rotationSpeed[1],this.mesh.rotation.z+=.01*this.rotationSpeed[2]};var a=new THREE.OBJLoader;a.load("/obj/pillow-box.obj",r),t(e)})}function l(e){return W.promise(function(t,n){var o=0,r=0;!function i(t){window.requestAnimationFrame(i),r=t-o,o=t,e.preRenderFns.forEach(function(e){return e(r,t)}),e.renderer.render(e.scene,e.camera)}(o),t(e)})}function d(e,t){return e.preRenderFns.push(t),e}function m(e,t,n,o){return e.camera.position.x=t,e.camera.position.y=n,e.camera.position.z=o,e}function p(e,t,n,o){return W.isDefined(t)&&null!==t&&(e.velocity[0]=t),W.isDefined(n)&&null!==n&&(e.velocity[1]=n),W.isDefined(o)&&null!==o&&(e.velocity[2]=o),e}var h=W.composePromisers(t,n,o,i,r,s,a,u,c,l);return{makeViz:e,initViz:h,setVelocity:p}}(),makeApp=function(){return{wsUrl:W.join("https:"===document.location.protocol?"wss://":"ws://",document.location.host,"/")}},initApp=W.composePromisers(makeWebSocketClient,addPunterCid,makePunterVizs,makeRestRadioButtons);$(function(){initApp(makeApp()).success(function(e){report("OK","TheWorkers.net"),window.app=e})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbC5qcyIsIm1haW4uanMiLCJwdW50ZXItdml6LmpzIl0sIm5hbWVzIjpbIm1ha2VXZWJTb2NrZXRDbGllbnQiLCJhcHAiLCJXIiwicHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJjb25zb2xlIiwibG9nIiwid3NVcmwiLCJ3c0NsaWVudCIsIkpTT05Tb2NrZXRDb25uZWN0aW9uIiwic29ja2V0VXJsIiwicmVzb2x2ZU9uRmlyc3RDb25uZWN0Iiwib25jZSIsIiQiLCJyZW1vdmUiLCJyZXBvcnQiLCJvbiIsIm1ha2VSZXBvcnRlciIsIm9wZW5Tb2NrZXRDb25uZWN0aW9uIiwiYWRkUHVudGVyQ2lkIiwicHVudGVyQ2lkIiwiZGF0YSIsIm1ha2VQdW50ZXJWaXpzIiwidG9BcnJheSIsIm1hcCIsImVsIiwicHVudGVyVml6IiwiUHVudGVyVml6IiwibWFrZVZpeiIsImNvbnRhaW5lckVsIiwiaW5pdFZpeiIsImVycm9yIiwiZXJyIiwic3VjY2VzcyIsInZpeiIsIndpbmRvdyIsImxvY2F0aW9uIiwic2VhcmNoIiwiaW5kZXhPZiIsInJhbmdlRWwiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJzZXRBdHRyaWJ1dGUiLCJhc0V2ZW50U3RyZWFtIiwiZXZlbnQiLCJjdXJyZW50VGFyZ2V0IiwidmFsIiwib25WYWx1ZSIsInYiLCJzZXRWZWxvY2l0eSIsInByZXBlbmQiLCJyb3RhdGlvblN0ZXAiLCJvcmllbnRhdGlvblN0cmVhbSIsImUiLCJvcmlnaW5hbEV2ZW50IiwiZ2FtbWEiLCJhbHBoYSIsImJldGEiLCJnYW1tYVN0cmVhbSIsImFyciIsImRldmljZVJvdGF0aW9uIiwidGhyb3R0bGUiLCJnIiwic2tpcER1cGxpY2F0ZXMiLCJkaXJlY3Rpb24iLCJjb250cm9sTW9kZSIsIlJlc3Rlc3F1ZVV0aWwiLCJwb3N0IiwiTWF0aCIsImFicyIsInNwZWVkIiwibWFrZVJlc3RSYWRpb0J1dHRvbnMiLCIkZWwiLCIkd3JhcHBlckVsIiwicGFyZW50IiwicHJldmVudERlZmF1bHQiLCJzdWJzY3JpYmVSYWRpb0ZlaWxkU2V0Iiwic3Vic2NyaWJlV2l0aEluaXRpYWxHZXQiLCJwYWNrZXQiLCJyYWRpb0VscyIsInByb3AiLCJjaGVja2JveHJhZGlvIiwiZmlsdGVyIiwiZ2V0Qm9keSIsImF0dHIiLCJmaW5kIiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImZuIiwiaGFzVHJpZ2dlcmVkIiwic3RhdHVzIiwic3RyIiwicmVzdCIsImFyZ3VtZW50cyIsImpvaW4iLCJyZXBvcnRBcmdzIiwiYXBwbHkiLCJ0aGlzIiwiY2FsbGVlQXJncyIsImJhY2tyb3VuZENvbG9yIiwidmVsb2NpdHkiLCJwcmVSZW5kZXJGbnMiLCJwcmVDdWJlQ2FtUmVuZGVyRm5zIiwicG9zdEN1YmVDYW1SZW5kZXJGbnMiLCJ1bmRlZmluZWQiLCJoZWlnaHQiLCJ3aWR0aCIsInN3YXJtQ29sb3IiLCJUSFJFRSIsIkNvbG9yIiwiYmFja2dyb3VuZENvbG9yIiwic3Vic2NyaWJlVG9Ib3N0Q29udHJvbE1vZGUiLCJzdWJzY3JpYmUiLCJtYWtlQ2FtZXJhU2NlbmVSZW5kZXJlciIsImNhbWVyYSIsIlBlcnNwZWN0aXZlQ2FtZXJhIiwic2V0Q2FtZXJhUG9zaXRpb24iLCJzY2VuZSIsIlNjZW5lIiwiZm9nIiwiRm9nIiwicmVuZGVyZXIiLCJXZWJHTFJlbmRlcmVyIiwiYW50aWFsaWFzIiwic2V0UGl4ZWxSYXRpbyIsImRldmljZVBpeGVsUmF0aW8iLCJzZXRTaXplIiwic2V0Q2xlYXJDb2xvciIsInNvcnRPYmplY3RzIiwiYXBwZW5kQ2hpbGQiLCJkb21FbGVtZW50IiwibWFrZVdlYkNhbVRleHR1cmUiLCJ3ZWJDYW1FbCIsImF1dG9wbGF5IiwibmF2aWdhdG9yIiwid2Via2l0R2V0VXNlck1lZGlhIiwidmlkZW8iLCJzdHJlYW0iLCJzcmMiLCJVUkwiLCJjcmVhdGVPYmplY3RVUkwiLCJ3ZWJDYW1UZXh0dXJlIiwiVGV4dHVyZSIsIm1pbkZpbHRlciIsIkxpbmVhckZpbHRlciIsImFkZFByZVJlbmRlckZuIiwiZGV0bGFNUyIsInRpbWVzdGFtcE1TIiwicmVhZHlTdGF0ZSIsIkhBVkVfRU5PVUdIX0RBVEEiLCJuZWVkc1VwZGF0ZSIsIm1ha2VDdWJlQ2FtIiwiY3ViZUNhbWVyYSIsIkN1YmVDYW1lcmEiLCJyZW5kZXJUYXJnZXQiLCJMaW5lYXJNaXBNYXBMaW5lYXJGaWx0ZXIiLCJkZWx0YU1TIiwiZm9yRWFjaCIsInVwZGF0ZUN1YmVNYXAiLCJtYWtlV2ViQ2FtTWF0ZXJpYWwiLCJ3ZWJDYW1NYXRlcmlhbCIsIk1lc2hCYXNpY01hdGVyaWFsIiwiY29sb3IiLCJzaWRlIiwiRG91YmxlU2lkZSIsIm1ha2VCaWxsYm9hcmRCYWNrZ3JvdW5kIiwidGV4dHVyZSIsIkltYWdlVXRpbHMiLCJsb2FkVGV4dHVyZSIsIk5lYXJlc3RGaWx0ZXIiLCJtYWdGaWxlciIsIm1hdGVyaWFsIiwidHJhbnNwYXJlbnQiLCJnZW9tZXRyeSIsIlBsYW5lQnVmZmVyR2VvbWV0cnkiLCJtZXNoIiwiTWVzaCIsInRyYW5zbGF0ZVoiLCJhZGQiLCJwdXNoIiwidmlzaWJsZSIsIm1ha2VXZWJDYW1IZWRyb25NZXNoIiwib25PYmpMb2FkZWQiLCJvYmoiLCJjaGlsZHJlbiIsIndlYkNhbUhlZHJvbk1lc2giLCJjbG9uZSIsInNjYWxlIiwic2V0IiwicmFuZG9tQmV0d2VlbiIsInJvdGF0aW9uIiwieCIsInkiLCJ6Iiwid2lyZWZyYW1lIiwibG9hZGVyIiwiT0JKTG9hZGVyIiwibG9hZCIsIm1ha2VMaWdodHMiLCJBbWJpZW50TGlnaHQiLCJkaXJlY3Rpb25hbExpZ2h0IiwiRGlyZWN0aW9uYWxMaWdodCIsInBvc2l0aW9uIiwibm9ybWFsaXplIiwibWFrZVN3YXJtIiwiUGFydGljbGUiLCJ0b1JhZCIsImFuY2hvciIsIk9iamVjdDNEIiwicmFuZ2UiLCJ0cmFuc2xhdGVYIiwidHJhbnNsYXRlWSIsImRpc3RhbmNlIiwiZGlzdGFuY2VUbyIsInNjYWxlTXV0aXBsaWVyIiwiZCIsImludGVycG9sYXRpb25zIiwicXVhcnRpY0Vhc2VPdXQiLCJyIiwicm90YXRpb25TcGVlZCIsInJhbmRvbSIsIm1heFBhcnRpY2xlcyIsIm1pbkNyZWF0aW9uVGltZSIsIm1heENyZWF0aW9uVGltZU1TIiwiY3JlYXRlTW9yZSIsInBhcnRpY2xlcyIsImxlbmd0aCIsInBhcnRpY2xlIiwic3dhcm1PYmplY3QzRCIsInNldFRpbWVvdXQiLCJlYXNlSW4iLCJ1cGRhdGUiLCJNZXNoUGhvbmdNYXRlcmlhbCIsInNoaW5pbmVzcyIsInNwZWN1bGFyIiwiZW52TWFwIiwicmVmbGVjdGl2aXR5IiwicHJvdG90eXBlIiwibWF4IiwibWFrZVJlbmRlckxvb3AiLCJsYXN0VGltZXN0YW1wTVMiLCJsb29wIiwiY3VycmVudFRpbWVzdGFtcE1TIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwicmVuZGVyIiwiaXNEZWZpbmVkIiwiY29tcG9zZVByb21pc2VycyIsIm1ha2VBcHAiLCJwcm90b2NvbCIsImhvc3QiLCJpbml0QXBwIl0sIm1hcHBpbmdzIjoiQUFRQSxZQ3lCQSxTQUFTQSxxQkFBc0JDLEdBQzNCLE1BQU9DLEdBQUVDLFFBQVMsU0FBV0MsRUFBU0MsR0FDbENDLFFBQVFDLElBQUssa0NBQW1DTixFQUFJTyxPQUVwRFAsRUFBSVEsU0FBVyxHQUFJUCxHQUFFUSxzQkFDakJDLFVBQVdWLEVBQUlPLE9BR25CLElBQUlJLEdBQXdCQyxLQUFNLFdBQzlCQyxFQUFHLCtCQUFnQ0MsU0FDbkNDLE9BQVEsWUFBYSxNQUFPZixFQUFJTyxPQUNoQ0osRUFBU0gsSUFHYkEsR0FBSVEsU0FBU1EsR0FBSSxPQUFRTCxHQUN6QlgsRUFBSVEsU0FBU1EsR0FBSSxRQUFTQyxhQUFjLHFCQUN4Q2pCLEVBQUlRLFNBQVNRLEdBQUksUUFBU0MsYUFBYyxxQkFDeENqQixFQUFJUSxTQUFTVSx5QkFJckIsUUFBU0MsY0FBZW5CLEdBQ3BCLE1BQU9DLEdBQUVDLFFBQVMsU0FBV0MsRUFBU0MsR0FDbENKLEVBQUlvQixVQUFZUCxFQUFHLHFCQUFzQlEsS0FBTSxhQUMvQ2xCLEVB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QURBdEQsR0FBSW1FLGFBQWE4RSxLQUFNM0YsR0FDaEJ0RCxFQUtYLFFBQVNrRixHQUFvQmxGLEVBQUs2SixFQUFHQyxFQUFHQyxHQUlwQyxNQUhBL0osR0FBSWdGLE9BQU93RixTQUFTWCxFQUFJQSxFQUN4QjdKLEVBQUlnRixPQUFPd0YsU0FBU1YsRUFBSUEsRUFDeEI5SixFQUFJZ0YsT0FBT3dGLFNBQVNULEVBQUlBLEVBQ2pCL0osRUFHWCxRQUFTZSxHQUFjZixFQUFLNkosRUFBR0MsRUFBR0MsR0FJOUIsTUFIS2hNLEdBQUVvUCxVQUFXdEQsSUFBYSxPQUFOQSxJQUFlN0osRUFBSWtFLFNBQVUsR0FBTTJGLEdBQ3ZEOUwsRUFBRW9QLFVBQVdyRCxJQUFhLE9BQU5BLElBQWU5SixFQUFJa0UsU0FBVSxHQUFNNEYsR0FDdkQvTCxFQUFFb1AsVUFBV3BELElBQWEsT0FBTkEsSUFBZS9KLEVBQUlrRSxTQUFVLEdBQU02RixHQUNyRC9KLEVBcmNYLEdBQUlKLEdBQVU3QixFQUFFcVAsaUJBQWtCdkksRUFDQUUsRUFDQWtCLEVBQ0E0QixFQUNBUixFQUVBOEIsRUFDQWhCLEVBQ0F1QyxFQUNBTixFQUNBeUMsRUFnY2xDLFFBQ0luTixRQUFTQSxFQUNURSxRQUFTQSxFQUNUbUIsWUFBYUEsTURqZWpCc00sUUFBVSxXQUNWLE9BQ0loUCxNQUFPTixFQUFFNkYsS0FBcUMsV0FBL0J0RCxTQUFTSixTQUFTb04sU0FBd0IsU0FBVyxRQUNyRGhOLFNBQVNKLFNBQVNxTixLQUNsQixPQUluQkMsUUFBVXpQLEVBQUVxUCxpQkFBa0J2UCxvQkFDQW9CLGFBQ0FHLGVBQ0FpRCxxQkFFbEMxRCxHQUFHLFdBQ0M2TyxRQUFTSCxXQUNSdE4sUUFBUyxTQUFXakMsR0FDakJlLE9BQVEsS0FBTSxrQkFDZG9CLE9BQU9uQyxJQUFNQSIsImZpbGUiOiJhbGwuanMiLCJzb3VyY2VzQ29udGVudCI6W251bGwsIi8qIGpzaGludCBlc25leHQ6IHRydWUgKi9cblxuLy8gTWFpbi5qc1xuLy8gPT09PT09PVxuLy8gRW50cnkgcG9pbnQgb2YgdGhlIGFwcGxpY2F0aW9uLlxuXG4vLyBNYWtlICYgSW5pdFxuLy8gPT09PT09PT09PT1cblxudmFyIG1ha2VBcHAgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgd3NVcmw6IFcuam9pbiggZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonID8gJ3dzczovLycgOiAnd3M6Ly8nLFxuICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5sb2NhdGlvbi5ob3N0LCAvL2RvY3VtZW50LicvLy8nLy8nd3NzOi8vMTkyLjE2OC4wLjc6NzA4MCdcbiAgICAgICAgICAgICAgICAgICAgICAgJy8nIClcbiAgICB9O1xufTtcblxudmFyIGluaXRBcHAgPSBXLmNvbXBvc2VQcm9taXNlcnMoIG1ha2VXZWJTb2NrZXRDbGllbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkUHVudGVyQ2lkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VQdW50ZXJWaXpzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VSZXN0UmFkaW9CdXR0b25zICk7XG5cbiQoIGZ1bmN0aW9uICgpIHtcbiAgICBpbml0QXBwKCBtYWtlQXBwKCkgKVxuICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAoIGFwcCApIHtcbiAgICAgICAgcmVwb3J0KCAnT0snLCAnVGhlV29ya2Vycy5uZXQnICk7XG4gICAgICAgIHdpbmRvdy5hcHAgPSBhcHA7XG4gICAgfSk7XG59KTtcblxuLy8gUHJvbWlzZXJzXG4vLyA9PT09PT09PT1cblxuZnVuY3Rpb24gbWFrZVdlYlNvY2tldENsaWVudCAoIGFwcCApIHtcbiAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgY29uc29sZS5sb2coICdDb25uZWN0aW5nIHRvIHdlYnNvY2tldCBjbGllbnQ6JywgYXBwLndzVXJsICk7XG4gICAgICAgIFxuICAgICAgICBhcHAud3NDbGllbnQgPSBuZXcgVy5KU09OU29ja2V0Q29ubmVjdGlvbih7XG4gICAgICAgICAgICBzb2NrZXRVcmw6IGFwcC53c1VybFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXNvbHZlT25GaXJzdENvbm5lY3QgPSBvbmNlKCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAkKCAnW2RhdGEtZGlzY29ubmVjdGVkLXdhcm5pbmddJyApLnJlbW92ZSgpO1xuICAgICAgICAgICAgcmVwb3J0KCAnQ09OTkVDVEVEJywgJ3RvOicsIGFwcC53c1VybCApO1xuICAgICAgICAgICAgcmVzb2x2ZSggYXBwICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGFwcC53c0NsaWVudC5vbiggJ29wZW4nLCByZXNvbHZlT25GaXJzdENvbm5lY3QgKTtcbiAgICAgICAgYXBwLndzQ2xpZW50Lm9uKCAnZXJyb3InLCBtYWtlUmVwb3J0ZXIoICdXZWIgU29ja2V0IEVycm9yJyApICk7XG4gICAgICAgIGFwcC53c0NsaWVudC5vbiggJ2Nsb3NlJywgbWFrZVJlcG9ydGVyKCAnV2ViIFNvY2tldCBDbG9zZScgKSApO1xuICAgICAgICBhcHAud3NDbGllbnQub3BlblNvY2tldENvbm5lY3Rpb24oKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gYWRkUHVudGVyQ2lkICggYXBwICkge1xuICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICBhcHAucHVudGVyQ2lkID0gJCggJ1tkYXRhLXB1bnRlci1jaWRdJyApLmRhdGEoICdwdW50ZXJDaWQnICk7XG4gICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgIH0pO1xufVxuXG4vLyBQdW50ZXIgVml6XG4vLyAtLS0tLS0tLS0tXG5cbmZ1bmN0aW9uIG1ha2VQdW50ZXJWaXpzICggYXBwICkge1xuICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAkKCBcIltkYXRhLXB1bnRlci12aXpdXCIgKVxuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLm1hcCggZnVuY3Rpb24gKCBlbCApIHtcbiAgICAgICAgICAgICAgICAvLyBNYWtlIHRoZSBwdW50ZXIgYXBwbGljYXRpb25cbiAgICAgICAgICAgICAgICBhcHAucHVudGVyVml6ID0gUHVudGVyVml6Lm1ha2VWaXooKTtcbiAgICAgICAgICAgICAgICAvLyBBZGQgb3V0IGRvbSBlbGVtZW50XG4gICAgICAgICAgICAgICAgYXBwLnB1bnRlclZpei5jb250YWluZXJFbCA9IGVsO1xuICAgICAgICAgICAgICAgIC8vIFdlYlNvY2tldHNcbiAgICAgICAgICAgICAgICBhcHAucHVudGVyVml6LndzQ2xpZW50ID0gYXBwLndzQ2xpZW50O1xuXG4gICAgICAgICAgICAgICAgLy8gSW5pdGFpbGlzZSBpdFxuXG4gICAgICAgICAgICAgICAgdmFyIEZPUldBUkRTX0hJR0ggPSBbIFsgJy8nIF0gXTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBQdW50ZXJWaXpcbiAgICAgICAgICAgICAgICAgICAgLmluaXRWaXooIGFwcC5wdW50ZXJWaXogKVxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoIGZ1bmN0aW9uICggZXJyICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvciggJ0ZhaWxlZCB0byBjcmVhdGUgUHVudGVyIGFwcCcsIGVyciApO1xuICAgICAgICAgICAgICAgICAgICB9KSBcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoIGZ1bmN0aW9uICggdml6ICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBEZXZpY2UgUm90YXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vID09PT09PT09PT09PT09PVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb24tTW9iaWxlIC8gRGVidWdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluZGV4T2YoICdkZWJ1ZycpID4gLTEgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBNYWtlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJhbmdlRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnaW5wdXQnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2VFbC5zZXRBdHRyaWJ1dGUoICd0eXBlJywgJ3JhbmdlJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlRWwuc2V0QXR0cmlidXRlKCAnbWluJywgLTEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZUVsLnNldEF0dHJpYnV0ZSggJ21heCcsIDEgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZUVsLnNldEF0dHJpYnV0ZSggJ3N0ZXAnLCAwLjAxICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2VFbC5zZXRBdHRyaWJ1dGUoICd2YWx1ZScsIDAuMjUgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZUVsLnNldEF0dHJpYnV0ZSggJ3N0eWxlJywgJ3Bvc2l0aW9uOiBhYnNvbHV0ZScgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIHJhbmdlRWwgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXNFdmVudFN0cmVhbSggJ2NoYW5nZScgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKCBldmVudCA9PiBldmVudC5jdXJyZW50VGFyZ2V0IClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCggZWwgPT4gJCggZWwgKS52YWwoKSApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vblZhbHVlKCB2ID0+IFB1bnRlclZpei5zZXRWZWxvY2l0eSggdml6LCBudWxsLCB2LCBudWxsICkgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoICcjcHVudGVyJyApLnByZXBlbmQoIHJhbmdlRWwgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTW9iaWxlXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAtLS0tLS1cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByb3RhdGlvblN0ZXAgPSAyNS43MTQyODU3MTQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgcm90YXRpb24gY29udHJvbHNcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdhbW1hIHJpZ2h0IDkwLCBsZWZ0IC05MFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9yaWVudGF0aW9uU3RyZWFtID0gICQoIHdpbmRvdyApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hc0V2ZW50U3RyZWFtKCAnZGV2aWNlb3JpZW50YXRpb24nIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCggZSA9PiBbIGUub3JpZ2luYWxFdmVudC5nYW1tYSwgZS5vcmlnaW5hbEV2ZW50LmFscGhhLCBlLm9yaWdpbmFsRXZlbnQuYmV0YSBdICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnYW1tYVN0cmVhbSA9IG9yaWVudGF0aW9uU3RyZWFtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCggYXJyID0+IGFyclsgMCBdICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgYmFja2dyb3VuZFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb25TdHJlYW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAub25WYWx1ZSggZnVuY3Rpb24gKCBhcnIgICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ3VwZGF0aW5nJywgYXJyICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpei5kZXZpY2VSb3RhdGlvbiA9IGFycjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgb3JpZW50YXRpb25TdHJlYW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhyb3R0bGUoIDEwMCApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9uVmFsdWUoIGFyciA9PiBQdW50ZXJWaXouc2V0VmVsb2NpdHkoIHZpeiwgbnVsbCwgVy5tYXAoIGFyclswXSwgLTE4MCwgMTgwLCAtMSwgMSwgdHJ1ZSApLCBudWxsICkgKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3JpZW50YXRpb25TdHJlYW1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICAub25WYWx1ZSggYXJyID0+IHZpei5jYW1lcmEucm90YXRpb24ueiA9IGFyclsgMSBdICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gWyBiaCwgYm0sIGJsLCBuLCBmbCwgZm0sIGZoIF1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gRm9yd2FyZHMgJiBCYWNrd2FyZHNcbiAgICAgICAgICAgICAgICAgICAgICAgIGdhbW1hU3RyZWFtXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCggZnVuY3Rpb24gKCBnICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIGcgPCAtcm90YXRpb25TdGVwICkgeyByZXR1cm4gJ2JhY2t3YXJkJzsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICggZyA+IHJvdGF0aW9uU3RlcCApIHsgcmV0dXJuICdmb3J3YXJkJzsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsgcmV0dXJuICdub25lJzsgfSBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5za2lwRHVwbGljYXRlcygpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRocm90dGxlKCAxMDAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vblZhbHVlKCBmdW5jdGlvbiAoIGRpcmVjdGlvbiApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAncGhvbmUtJyArIGFwcC5wdW50ZXJDaWQgPT09IGFwcC5jb250cm9sTW9kZSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFJlc3Rlc3F1ZVV0aWwucG9zdCggYXBwLndzQ2xpZW50LCAnL21vdG9yL3JvdGF0aW9uL2RpcmVjdGlvbi8nLCBkaXJlY3Rpb24gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTcGVlZFxuICAgICAgICAgICAgICAgICAgICAgICAgZ2FtbWFTdHJlYW1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKCBnID0+IE1hdGguYWJzKCBnICkgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoIGZ1bmN0aW9uICggZyApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBnID4gOTAgLSByb3RhdGlvblN0ZXAgKSB7IHJldHVybiAnaGlnaCc7IH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIGcgPiA5MCAtICggcm90YXRpb25TdGVwICogMiApICkgeyByZXR1cm4gJ21lZGl1bSc7IH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7IHJldHVybiAnbG93JzsgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnRocm90dGxlKCAxMDAgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vblZhbHVlKCBmdW5jdGlvbiAoIHNwZWVkICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoICdwaG9uZS0nICsgYXBwLnB1bnRlckNpZCA9PT0gYXBwLmNvbnRyb2xNb2RlICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgUmVzdGVzcXVlVXRpbC5wb3N0KCBhcHAud3NDbGllbnQsICcvbW90b3Ivcm90YXRpb24vc3BlZWQvJywgc3BlZWQgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ1B1bnRlciBhcHBsaWNhdGlvbiBtYWRlJyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgIH0pO1xufVxuXG4vLyBqUXVlcnkgTW9iaWxlIFVpIEJpbmRpbmdzXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmZ1bmN0aW9uIG1ha2VSZXN0UmFkaW9CdXR0b25zICggYXBwICkge1xuICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAvLyBSYWRpbyBCdXR0b25zXG4gICAgICAgIC8vID09PT09PT09PT09PT1cbiAgICAgICAgJCggJ1tkYXRhLXJlc3QtdHlwZT1cInJhZGlvLXBvc3RcIl0nIClcbiAgICAgICAgICAgIC50b0FycmF5KClcbiAgICAgICAgICAgIC5tYXAoICQgKVxuICAgICAgICAgICAgLm1hcCggZnVuY3Rpb24gKCAkZWwgKSB7XG4gICAgICAgICAgICAgICAgLy8gRGlzYWJsZSByZWFsIGV2ZW50c1xuICAgICAgICAgICAgICAgIHZhciAkd3JhcHBlckVsID0gJGVsLnBhcmVudCgpO1xuICAgICAgICAgICAgICAgICR3cmFwcGVyRWwub24oICdjbGljayB0b3VjaGVuZCcsIGZ1bmN0aW9uICggZSApIHtcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ3NlbmRpbmcnLCRlbC52YWwoKSwgJ3RvJywgJGVsLmRhdGEoICdyZXN0VXJpJyApICApO1xuICAgICAgICAgICAgICAgICAgICBSZXN0ZXNxdWVVdGlsLnBvc3QoIGFwcC53c0NsaWVudCwgJGVsLmRhdGEoICdyZXN0VXJpJyApLCAkZWwudmFsKCkgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gUmFkaW8gRmllbGQgU2V0c1xuICAgICAgICAvLyA9PT09PT09PT09PT09PT09XG4gICAgICAgICQoICdbZGF0YS1yZXN0LXR5cGU9XCJmZWlsZHNldFwiXScgKVxuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLm1hcCggJCApXG4gICAgICAgICAgICAubWFwKCBmdW5jdGlvbiAoICRlbCApIHtcblxuICAgICAgICAgICAgICAgIHZhciByYWRpb0VscyA9ICRlbC5maW5kKCAnaW5wdXRbdHlwZT1cInJhZGlvXCJdJyApLmNoZWNrYm94cmFkaW8oKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggICdHb3QgYSBmaWVsZCBzZXQnLCAkZWwuZGF0YSggJ3Jlc3RVcmknICkgKTtcblxuICAgICAgICAgICAgICAgIHN1YnNjcmliZVJhZGlvRmVpbGRTZXQoKTtcbiAgICAgICAgICAgICAgICBhcHAud3NDbGllbnQub24oICdvcGVuJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyggJ1N1YnNjcmlibmlnOicsICAkZWwuZGF0YSggJ3Jlc3RVcmknICkgKTtcbiAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlUmFkaW9GZWlsZFNldCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gc3Vic2NyaWJlUmFkaW9GZWlsZFNldCgpIHtcbiAgICAgICAgICAgICAgICAgICAgUmVzdGVzcXVlVXRpbC5zdWJzY3JpYmVXaXRoSW5pdGlhbEdldCggYXBwLndzQ2xpZW50LCAkZWwuZGF0YSggJ3Jlc3RVcmknICksIGZ1bmN0aW9uICggcGFja2V0ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmFkaW9FbHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucHJvcCggJ2NoZWNrZWQnLCBmYWxzZSApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNoZWNrYm94cmFkaW8oICdyZWZyZXNoJyApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlciggJ2lucHV0W3ZhbHVlPVwiJysgcGFja2V0LmdldEJvZHkoKSArJ1wiXScgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCAnY2hlY2tlZCcsICdjaGVja2VkJyApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNoZWNrYm94cmFkaW8oICdyZWZyZXNoJyApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbmQoICdsYWJlbCcgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVDbGFzcyggJ3VpLXJhZGlvLW9mZicgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyggJ3VpLXJhZGlvLW9uJyApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgIH0pO1xufVxuXG4vLyBVdGlsc1xuLy8gPT09PT1cblxuLy8gRnVuY3Rpb25cbi8vIC0tLS0tLS0tXG4gICAgXG5mdW5jdGlvbiBvbmNlICggZm4gKSB7XG4gICAgdmFyIGhhc1RyaWdnZXJlZCA9IGZhbHNlO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICggISBoYXNUcmlnZ2VyZWQgKSB7XG4gICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgaGFzVHJpZ2dlcmVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8vIFJlcG9ydGluZ1xuLy8gLS0tLS0tLS0tXG5cbmZ1bmN0aW9uIHJlcG9ydCggc3RhdHVzLCBzdHIgKSB7XG4gICAgY29uc29sZS5sb2coICdbJywgc3RhdHVzLCAnXScsIFcucmVzdCggVy50b0FycmF5KCBhcmd1bWVudHMgKSApLmpvaW4oICcgJyApICk7XG59XG5cbmZ1bmN0aW9uIG1ha2VSZXBvcnRlciggc3RhdHVzLCBzdHIgKSB7XG4gICAgdmFyIHJlcG9ydEFyZ3MgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmVwb3J0LmFwcGx5KCB0aGlzLCByZXBvcnRBcmdzICk7XG4gICAgICAgIHZhciBjYWxsZWVBcmdzID0gYXJndW1lbnRzO1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgICAgIHJlc29sdmUuYXBwbHkoIHRoaXMsIGNhbGxlZUFyZ3MgKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn1cbiIsIi8qIGpzaGludCBlc25leHQ6IHRydWUgKi9cblxuLy8gUHVudGVyIFZpelxuLy8gPT09PT09PT09PVxuLy8gQSB0aHJlZS5qcyB2aXN1bGlzYXRpb24gdG8gYmVcbi8vIHJ1biBvbiBhbiBIVEMgcGhvbmUgYW5kIGNhcnJpZWQgYnlcbi8vIHB1bnRlcnMgaW50byB0aGUgbWlycm9yIGJveC5cblxudmFyIFB1bnRlclZpeiA9IChmdW5jdGlvbiAoKSB7XG5cbiAgICAvLyBJbml0ICYgbWFrZVxuICAgIC8vID09PT09PT09PT09XG4gICAgZnVuY3Rpb24gbWFrZVZpeiAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBjb250YWluZXJFbDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKSxcbiAgICAgICAgICAgIGJhY2tyb3VuZENvbG9yOiAweDYxNjI2NCxcbiAgICAgICAgICAgIHZlbG9jaXR5OiBbIDAsIDAsIDAgXSxcbiAgICAgICAgICAgIGRldmljZVJvdGF0aW9uOiBbIDAsIDAsIDAgXSxcbiAgICAgICAgICAgIHByZVJlbmRlckZuczogW10sXG4gICAgICAgICAgICBwcmVDdWJlQ2FtUmVuZGVyRm5zOiBbXSxcbiAgICAgICAgICAgIHBvc3RDdWJlQ2FtUmVuZGVyRm5zOiBbXSxcbiAgICAgICAgICAgIHdzQ2xpZW50OiB1bmRlZmluZWQsXG4gICAgICAgICAgICBoZWlnaHQ6IDY0MCxcbiAgICAgICAgICAgIHdpZHRoOiAzNjAsXG4gICAgICAgICAgICBzd2FybUNvbG9yOiBuZXcgVEhSRUUuQ29sb3IoIDB4ZmZmZmZmICksXG4gICAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IG5ldyBUSFJFRS5Db2xvciggMHhBNUNGNEMgKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHZhciBpbml0Vml6ID0gVy5jb21wb3NlUHJvbWlzZXJzKCBzdWJzY3JpYmVUb0hvc3RDb250cm9sTW9kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZUNhbWVyYVNjZW5lUmVuZGVyZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VXZWJDYW1UZXh0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlV2ViQ2FtTWF0ZXJpYWwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VDdWJlQ2FtLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWtlV2ViQ2FtQm94TWVzaCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVdlYkNhbUhlZHJvbk1lc2gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VCaWxsYm9hcmRCYWNrZ3JvdW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlU3dhcm0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VMaWdodHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VSZW5kZXJMb29wICk7XG5cbiAgICAvLyBQcm9taXNlcnNcbiAgICAvLyA9PT09PT09PT1cblxuICAgIC8vIFJlc3Rlc3F1ZVxuICAgIC8vIC0tLS0tLS0tLVxuICAgIGZ1bmN0aW9uIHN1YnNjcmliZVRvSG9zdENvbnRyb2xNb2RlICggdml6ICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgICAgIHZpei5jb250cm9sTW9kZSA9ICcnO1xuXG4gICAgICAgICAgICBzdWJzY3JpYmUoKTtcbiAgICAgICAgICAgIHZpei53c0NsaWVudC5vbiggJ29wZW4nLCBzdWJzY3JpYmUgKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gc3Vic2NyaWJlICgpIHtcbiAgICAgICAgICAgICAgICBSZXN0ZXNxdWVVdGlsXG4gICAgICAgICAgICAgICAgICAgIC5zdWJzY3JpYmVXaXRoSW5pdGlhbEdldCggYXBwLndzQ2xpZW50LCAnL2hvc3QvY29udHJvbC9tb2RlLycsIGZ1bmN0aW9uICggcGFja2V0ICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXBwLmNvbnRyb2xNb2RlID0gcGFja2V0LmdldEJvZHkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnQ29udHJvbCBNb2RlIENoYW5nZSB0bzonLCBhcHAuY29udHJvbE1vZGUgKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJlc29sdmUoIHZpeiApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBDYW1lcmEsIFNjZW5lLCBSZW5kZXJlclxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgZnVuY3Rpb24gbWFrZUNhbWVyYVNjZW5lUmVuZGVyZXIgKCB2aXogKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDYW1lcmFcbiAgICAgICAgICAgIC8vIC0tLS0tLVxuICAgICAgICAgICAgdml6LmNhbWVyYSA9IG5ldyBUSFJFRS5QZXJzcGVjdGl2ZUNhbWVyYSggNzAsIHZpei53aWR0aCAvIHZpei5oZWlnaHQsIDEsIDMwMDAwICk7XG4gICAgICAgICAgICBzZXRDYW1lcmFQb3NpdGlvbiggdml6LCAwLCAwLCAyMDAgKTtcblxuICAgICAgICAgICAgLy8gU2NlbmVcbiAgICAgICAgICAgIC8vIC0tLS0tXG4gICAgICAgICAgICB2aXouc2NlbmUgPSBuZXcgVEhSRUUuU2NlbmUoKTtcblxuICAgICAgICAgICAgdml6LnNjZW5lLmZvZyA9IG5ldyBUSFJFRS5Gb2coIDB4MDAwMDAwLCAwLCAzMDAwMCApO1xuXG4gICAgICAgICAgICAvLyBSZW5kZXJlclxuICAgICAgICAgICAgLy8gLS0tLS0tLS1cbiAgICAgICAgICAgIHZpei5yZW5kZXJlciA9IG5ldyBUSFJFRS5XZWJHTFJlbmRlcmVyKCB7IGFudGlhbGlhczogZmFsc2UgfSApO1xuICAgICAgICAgICAgdml6LnJlbmRlcmVyLnNldFBpeGVsUmF0aW8oIHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvICk7XG4gICAgICAgICAgICB2aXoucmVuZGVyZXIuc2V0U2l6ZSggdml6LndpZHRoLCB2aXouaGVpZ2h0ICk7XG4gICAgICAgICAgICB2aXoucmVuZGVyZXIuc2V0Q2xlYXJDb2xvciggdml6LmJhY2tncm91bmRDb2xvciApO1xuICAgICAgICAgICAgdml6LnJlbmRlcmVyLnNvcnRPYmplY3RzID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHZpei5jb250YWluZXJFbC5hcHBlbmRDaGlsZCggdml6LnJlbmRlcmVyLmRvbUVsZW1lbnQgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVzb2x2ZSggdml6ICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdlYiBDYW1cbiAgICAvLyAtLS0tLS0tXG4gICAgLy8gTWFrZSB0aGUgd2ViIGNhbSBhdmFpbGFibGUgYXMgYSB0ZXh0dXJlXG4gICAgZnVuY3Rpb24gbWFrZVdlYkNhbVRleHR1cmUgKCB2aXogKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgdmFyIHdlYkNhbUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKTtcbiAgICAgICAgICAgIHdlYkNhbUVsLmF1dG9wbGF5ID0gdHJ1ZTtcblxuICAgICAgICAgICAgLy8gV2ViIENhbSBTdHJlYW1cbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhKCB7IHZpZGVvOnRydWUgfSwgZnVuY3Rpb24oIHN0cmVhbSApe1xuICAgICAgICAgICAgICAgIHdlYkNhbUVsLnNyYyA9IFVSTC5jcmVhdGVPYmplY3RVUkwoIHN0cmVhbSApO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24oIGVyciApe1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRmFpbGVkIHRvIGdldCBhIHN0cmVhbSBkdWUgdG9cIiwgZXJyKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBXZWIgQ2FtIFRleHR1cmVcbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgdml6LndlYkNhbVRleHR1cmUgPSBuZXcgVEhSRUUuVGV4dHVyZSggd2ViQ2FtRWwgKTtcbiAgICAgICAgICAgIHZpei53ZWJDYW1UZXh0dXJlLm1pbkZpbHRlciA9IFRIUkVFLkxpbmVhckZpbHRlcjtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gUmVuZGVyIFVwZGF0ZXNcbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBhZGRQcmVSZW5kZXJGbiggdml6LCBmdW5jdGlvbiAoIGRldGxhTVMsIHRpbWVzdGFtcE1TICkge1xuICAgICAgICAgICAgICAgIGlmKCB3ZWJDYW1FbC5yZWFkeVN0YXRlID09PSB3ZWJDYW1FbC5IQVZFX0VOT1VHSF9EQVRBICl7XG4gICAgICAgICAgICAgICAgICAgIHZpei53ZWJDYW1UZXh0dXJlLm5lZWRzVXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVzb2x2ZSggdml6ICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEN1YmUgQ2FtZXJhXG4gICAgLy8gLS0tLS0tLS0tLS1cbiAgICAvLyBDcmVhdGUgYSBjdWJlIGNhbSBmb3IgYSBkeW5hbWljIGVudk1hcC5cbiAgICAvLyBUaGlzIGFsc28gZW5hYmxlcyB0d28gaG9va3M6IGBwcmVDdWJlQ2FtUmVuZGVyQWN0aW9uc2AgJiBgcG9zdEN1YmVDYW1SZW5kZXJBY3Rpb25zYFxuICAgIC8vIGluIHRoZSB2aXogZm9yIHRoYXQgb2JqZWN0M0QgaW4gdGhlIHNjZW5lIGNhbiBiZSB0dXJuZWQgb24gYW5kIG9mZiBkdXJpbmdcbiAgICAvLyB0aGUgd2ViY2FtcyByZW5kZXJcbiAgICBmdW5jdGlvbiBtYWtlQ3ViZUNhbSAoIHZpeiApIHsgXG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuXG4gICAgICAgICAgICB2aXouY3ViZUNhbWVyYSA9IG5ldyBUSFJFRS5DdWJlQ2FtZXJhKCAxLCAzMDAwMCwgMjU2ICk7IC8vIG5lYXIsIGZhciwgcmVzb2x1dGlvblxuICAgICAgICAgICAgdml6LmN1YmVDYW1lcmEucmVuZGVyVGFyZ2V0Lm1pbkZpbHRlciA9IFRIUkVFLkxpbmVhck1pcE1hcExpbmVhckZpbHRlcjsgLy8gbWlwbWFwIGZpbHRlclxuICAgICAgICAgICAgXG4gICAgICAgICAgICBhZGRQcmVSZW5kZXJGbiggdml6LCBmdW5jdGlvbiAoIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkgeyAgICBcbiAgICAgICAgICAgICAgICAvLyBSZW5kZXIgdGhlIGN1YmUgY2FtZXJhIHRvIGN1YmUgbWFwXG4gICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgIHZpei5wcmVDdWJlQ2FtUmVuZGVyRm5zLmZvckVhY2goIGZuID0+IGZuKCBkZWx0YU1TLCB0aW1lc3RhbXBNUyApICk7XG4gICAgICAgICAgICAgICAgdml6LmN1YmVDYW1lcmEudXBkYXRlQ3ViZU1hcCggdml6LnJlbmRlcmVyLCB2aXouc2NlbmUgKTtcbiAgICAgICAgICAgICAgICB2aXoucG9zdEN1YmVDYW1SZW5kZXJGbnMuZm9yRWFjaCggZm4gPT4gZm4oIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXNvbHZlKCB2aXogKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gV2ViIENhbSBNYXRlcmlhbFxuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS1cbiAgICBmdW5jdGlvbiBtYWtlV2ViQ2FtTWF0ZXJpYWwgKCB2aXogKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAgICAgdml6LndlYkNhbU1hdGVyaWFsID0gbmV3IFRIUkVFLk1lc2hCYXNpY01hdGVyaWFsKHtcbiAgICAgICAgICAgICAgICBtYXA6IHZpei53ZWJDYW1UZXh0dXJlLFxuICAgICAgICAgICAgICAgIGNvbG9yOiAweGZmZmZmZixcbiAgICAgICAgICAgICAgICBzaWRlOiBUSFJFRS5Eb3VibGVTaWRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJlc29sdmUoIHZpeiApO1xuICAgICAgICB9KTtcblxuICAgIH1cblxuICAgIC8vIFdlYiBDYW0gQm94IE1lc2hcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQ3JlYXRlcyBhIGJveCB3aXRoIHRoZSB3ZWIgY2FtIGRpc3BsYXllZFxuICAgIC8vIG9uIHRoZSBpbnNpZGUgb2YgZWFjaCBvZiBpdCdzIDYgc2lkZXNcbiAgICBmdW5jdGlvbiBtYWtlV2ViQ2FtQm94TWVzaCAoIHZpeiApIHtcbiAgICAgICAgcmV0dXJuIFcucHJvbWlzZSggZnVuY3Rpb24gKCByZXNvbHZlLCByZWplY3QgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZpei53ZWJDYW12Qm94TWVzaCA9IG5ldyBUSFJFRS5NZXNoKCBuZXcgVEhSRUUuQm94R2VvbWV0cnkoIDIwMDAsIDIwMDAsIDIwMDAgKSwgdml6LndlYkNhbU1hdGVyaWFsICk7XG5cbiAgICAgICAgICAgIHZhciByb3RhdGlvblggPSBXLnJhbmRvbUJldHdlZW4oIDAuMDAwMiwgMC4wMDAwMiApO1xuICAgICAgICAgICAgdmFyIHJvdGF0aW9uWSA9IFcucmFuZG9tQmV0d2VlbiggMC4wMDAyLCAwLjAwMDAyICk7XG4gICAgICAgICAgICB2YXIgcm90YXRpb25aID0gVy5yYW5kb21CZXR3ZWVuKCAwLjAwMDIsIDAuMDAwMDIgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSWYgd2Ugd2FudCB0byByb3RhdGUgaXRcbiAgICAgICAgICAgIGFkZFByZVJlbmRlckZuKCB2aXosIGZ1bmN0aW9uICggZGVsdGFNUywgdGltZXN0YW1wTVMgKSB7XG4gICAgICAgICAgICAgICAgdml6LndlYkNhbXZCb3hNZXNoLnJvdGF0aW9uLnggKz0gKCBkZWx0YU1TICogcm90YXRpb25YICk7XG4gICAgICAgICAgICAgICAgdml6LndlYkNhbXZCb3hNZXNoLnJvdGF0aW9uLnkgKz0gKCBkZWx0YU1TICogcm90YXRpb25ZICk7XG4gICAgICAgICAgICAgICAgdml6LndlYkNhbXZCb3hNZXNoLnJvdGF0aW9uLnogKz0gKCBkZWx0YU1TICogcm90YXRpb25aICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdml6LnNjZW5lLmFkZCggdml6LndlYkNhbXZCb3hNZXNoICk7XG5cbiAgICAgICAgICAgIC8vIFNob3cgaXQgb25seSBmb3IgdGhlIGN1YmUgY2FtXG4gICAgICAgICAgICB2aXoucHJlQ3ViZUNhbVJlbmRlckZucy5wdXNoKCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdml6LndlYkNhbXZCb3hNZXNoLnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHZpei5wb3N0Q3ViZUNhbVJlbmRlckZucy5wdXNoKCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdml6LndlYkNhbXZCb3hNZXNoLnZpc2libGUgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHJlc29sdmUoIHZpeiApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBtYWtlQmlsbGJvYXJkQmFja2dyb3VuZCAoIHZpeiApIHtcbiAgICAgICAgcmV0dXJuIFcucHJvbWlzZSggZnVuY3Rpb24gKCByZXNvbHZlLCByZWplY3QgKSB7XG4gICAgICAgICAgICB2YXIgdGV4dHVyZSA9ICBUSFJFRS5JbWFnZVV0aWxzLmxvYWRUZXh0dXJlKCAnL2ltYWdlL2JpbGxib2FyZC1iYWNrZ3JvdW5kLnBuZycgKTtcbiAgICAgICAgICAgIHRleHR1cmUubWluRmlsdGVyID0gVEhSRUUuTmVhcmVzdEZpbHRlcjtcbiAgICAgICAgICAgIHRleHR1cmUubWFnRmlsZXIgPSBUSFJFRS5OZWFyZXN0RmlsdGVyO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xuICAgICAgICAgICAgICAgIG1hcDogdGV4dHVyZSxcbiAgICAgICAgICAgICAgICBjb2xvcjogMHhmZmZmZmYsXG4gICAgICAgICAgICAgICAgdHJhbnNwYXJlbnQ6IHRydWVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2YXIgZ2VvbWV0cnkgPSBuZXcgVEhSRUUuUGxhbmVCdWZmZXJHZW9tZXRyeSggMzYwLCA2NDAgKTtcblxuICAgICAgICAgICAgdmFyIG1lc2ggPSBuZXcgVEhSRUUuTWVzaCggZ2VvbWV0cnksIG1hdGVyaWFsICk7XG5cbiAgICAgICAgICAgIG1lc2gudHJhbnNsYXRlWiggLTI1MCApO1xuXG4gICAgICAgICAgICB2aXouc2NlbmUuYWRkKCBtZXNoICk7XG5cbiAgICAgICAgICAgIHZpei5wcmVDdWJlQ2FtUmVuZGVyRm5zLnB1c2goIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBtZXNoLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB2aXoucG9zdEN1YmVDYW1SZW5kZXJGbnMucHVzaCggZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIG1lc2gudmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVzb2x2ZSggdml6ICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdlYiBDYW0gSGVkcm9uIE1lc2hcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgZnVuY3Rpb24gbWFrZVdlYkNhbUhlZHJvbk1lc2ggKCB2aXogKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuXG4gICAgICAgICAgICAvLyBMb2FkZXJcbiAgICAgICAgICAgIC8vIC0tLS0tLVxuICAgICAgICAgICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5PQkpMb2FkZXIoKTtcbiAgICAgICAgICAgIGxvYWRlci5sb2FkKCAnL29iai9oZWRyb24ub2JqJywgb25PYmpMb2FkZWQgKTtcblxuICAgICAgICAgICAgLy8gU3dhcm0gQ3JlYXRpb25cbiAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9uT2JqTG9hZGVkICggb2JqICkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCBvYmouY2hpbGRyZW5bIDAgXSApO1xuICAgICAgICAgICAgICAgIHZpei53ZWJDYW1IZWRyb25NZXNoID0gb2JqLmNoaWxkcmVuWyAwIF0uY2xvbmUoKTsgLy9uZXcgVEhSRUUuTWVzaCggbmV3IFRIUkVFLkJveEdlb21ldHJ5KCAyMDAwLCAyMDAwLCAyMDAwICksIG1hdGVyaWFsICk7XG4gICAgICAgICAgICAgICAgdml6LndlYkNhbUhlZHJvbk1lc2gubWF0ZXJpYWwgPSB2aXoud2ViQ2FtTWF0ZXJpYWwuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB2YXIgc2NhbGUgPSA2MDAwO1xuICAgICAgICAgICAgICAgIHZpei53ZWJDYW1IZWRyb25NZXNoLnNjYWxlLnNldCggc2NhbGUsIHNjYWxlLCBzY2FsZSApO1xuXG4gICAgICAgICAgICAgICAgdmFyIHJvdGF0aW9uWCA9IFcucmFuZG9tQmV0d2VlbiggMC4wMDAyLCAwLjAwMDAyICk7XG4gICAgICAgICAgICAgICAgdmFyIHJvdGF0aW9uWSA9IFcucmFuZG9tQmV0d2VlbiggMC4wMDAyLCAwLjAwMDAyICk7XG4gICAgICAgICAgICAgICAgdmFyIHJvdGF0aW9uWiA9IFcucmFuZG9tQmV0d2VlbiggMC4wMDAyLCAwLjAwMDAyICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gSWYgd2Ugd2FudCB0byByb3RhdGUgaXRcbiAgICAgICAgICAgICAgICBhZGRQcmVSZW5kZXJGbiggdml6LCBmdW5jdGlvbiAoIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkge1xuICAgICAgICAgICAgICAgICAgICB2aXoud2ViQ2FtSGVkcm9uTWVzaC5yb3RhdGlvbi54ICs9IHZpei52ZWxvY2l0eVsgMCBdICogMC41O1xuICAgICAgICAgICAgICAgICAgICB2aXoud2ViQ2FtSGVkcm9uTWVzaC5yb3RhdGlvbi55ICs9IHZpei52ZWxvY2l0eVsgMSBdICogMC41O1xuICAgICAgICAgICAgICAgICAgICB2aXoud2ViQ2FtSGVkcm9uTWVzaC5yb3RhdGlvbi56ICs9IHZpei52ZWxvY2l0eVsgMiBdICogMC41O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZpei5zY2VuZS5hZGQoIHZpei53ZWJDYW1IZWRyb25NZXNoICk7XG5cbiAgICAgICAgICAgICAgICAvLyBTaG93IGl0IG9ubHkgZm9yIHRoZSBjdWJlIGNhbVxuICAgICAgICAgICAgICAgIHZpei5wcmVDdWJlQ2FtUmVuZGVyRm5zLnB1c2goIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgdml6LndlYkNhbUhlZHJvbk1lc2gudmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHZpei53ZWJDYW1IZWRyb25NZXNoLndpcmVmcmFtZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB2aXoud2ViQ2FtSGVkcm9uTWVzaC5tYXRlcmlhbC5jb2xvci5zZXQoIDB4ZmZmZmZmICk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB2aXoucG9zdEN1YmVDYW1SZW5kZXJGbnMucHVzaCggZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICB2aXoud2ViQ2FtSGVkcm9uTWVzaC52aXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdml6LndlYkNhbUhlZHJvbk1lc2gubWF0ZXJpYWwuY29sb3Iuc2V0KCB2aXouYmFja2dyb3VuZENvbG9yICk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXNvbHZlKCB2aXogKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBMaWdodHNcbiAgICAvLyAtLS0tLS1cbiAgICBmdW5jdGlvbiBtYWtlTGlnaHRzICggdml6ICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgICAgIHZpei5zY2VuZS5hZGQoIG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoIDB4MjIyMjIyICkgKTtcblxuICAgICAgICAgICAgdmFyIGRpcmVjdGlvbmFsTGlnaHQgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCggMHhmZmZmZmYsIDIgKTtcbiAgICAgICAgICAgIGRpcmVjdGlvbmFsTGlnaHQucG9zaXRpb24uc2V0KCAyLCAxLjIsIDEwICkubm9ybWFsaXplKCk7XG4gICAgICAgICAgICB2aXouc2NlbmUuYWRkKCBkaXJlY3Rpb25hbExpZ2h0ICk7XG5cbiAgICAgICAgICAgIGRpcmVjdGlvbmFsTGlnaHQgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCggMHhmZmZmZmYsIDEgKTtcbiAgICAgICAgICAgIGRpcmVjdGlvbmFsTGlnaHQucG9zaXRpb24uc2V0KCAtMiwgMS4yLCAtMTAgKS5ub3JtYWxpemUoKTtcbiAgICAgICAgICAgIHZpei5zY2VuZS5hZGQoIGRpcmVjdGlvbmFsTGlnaHQgKTsgIFxuICAgICAgICAgICAgcmVzb2x2ZSggdml6ICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFN3YXJtXG4gICAgLy8gLS0tLS1cbiAgICBmdW5jdGlvbiBtYWtlU3dhcm0gKCB2aXogKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgcGFydGljbGVzID0gW107XG5cbiAgICAgICAgICAgIC8vIEFkZCB0byBTY2VuZVxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICB2aXouc3dhcm1PYmplY3QzRCA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgICAgICAgICAgdml6LnNjZW5lLmFkZCggdml6LnN3YXJtT2JqZWN0M0QgKTtcbiAgICAgICAgICAgIHZpei5wcmVDdWJlQ2FtUmVuZGVyRm5zLnB1c2goIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2aXouc3dhcm1PYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHZpei5wb3N0Q3ViZUNhbVJlbmRlckZucy5wdXNoKCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdml6LnN3YXJtT2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gVXBkYXRpbmdcbiAgICAgICAgICAgIGFkZFByZVJlbmRlckZuKCB2aXosIGZ1bmN0aW9uICggZGVsdGFNUywgdGltZXN0YW1wTVMgKSB7XG4gICAgICAgICAgICAgICAgcGFydGljbGVzLmZvckVhY2goIHBhcnRpY2xlID0+IHBhcnRpY2xlLnVwZGF0ZSggZGVsdGFNUywgdGltZXN0YW1wTVMgKSApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFBhcnRpY2xlIENsYXNzXG4gICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgZnVuY3Rpb24gUGFydGljbGUgKCBtZXNoICkge1xuXG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9IFsgMCwgMCwgMCBdO1xuXG4gICAgICAgICAgICAgICAgLy8gTWVzaFxuICAgICAgICAgICAgICAgIHRoaXMubWVzaCA9IG1lc2guY2xvbmUoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmFuY2hvciA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgICAgICAgICAgICAgIHRoaXMuYW5jaG9yLmFkZCggdGhpcy5tZXNoICk7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLm1hdGVyaWFsID0gUGFydGljbGUubWF0ZXJpYWwuY2xvbmUoKTtcbiAgICAgICAgICAgICAgICAvL3RoaXMubWVzaC5tYXRlcmlhbC5jb2xvci5vZmZzZXRIU0woIDAuMTUgLSBXLnJhbmRvbUJldHdlZW4oIC0wLjEsIDAuMSApLCAwLjMsIC0wLjMgKTtcbiAgICAgICAgICAgICAgICAvL3RoaXMubWVzaC5tYXRlcmlhbC5jb2xvci5zZXRTdHlsZSggJ3JnYiggMjQxLCA4NiwgMzUpJyApO1xuICAgICAgICAgICAgICAgIC8vdGhpcy5tZXNoLm1hdGVyaWFsLmNvbG9yLm9mZnNldEhTTCggMC4yMTk0NDQ0NDQsIDEsIC0wLjUgKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1lc2gubWF0ZXJpYWwuY29sb3IgPSB2aXouc3dhcm1Db2xvcjtcblxuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IDcwO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC50cmFuc2xhdGVYKCBXLnJhbmRvbUJldHdlZW4oIC1yYW5nZSwgcmFuZ2UgKSApO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC50cmFuc2xhdGVZKCBXLnJhbmRvbUJldHdlZW4oIC1yYW5nZSwgcmFuZ2UgKSApO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC50cmFuc2xhdGVaKCBXLnJhbmRvbUJldHdlZW4oIC1yYW5nZSwgcmFuZ2UgKSApO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5kaXN0YW5jZSA9IFcubWFwKCB0aGlzLm1lc2gucG9zaXRpb24uZGlzdGFuY2VUbyggdGhpcy5hbmNob3IucG9zaXRpb24gKSwgMCwgcmFuZ2UsIDEsIDAuMSwgdHJ1ZSApO1xuXG4gICAgICAgICAgICAgICAgdmFyIHNjYWxlTXV0aXBsaWVyID0gMjUwO1xuICAgICAgICAgICAgICAgIHZhciBkID0gVy5pbnRlcnBvbGF0aW9ucy5xdWFydGljRWFzZU91dCggdGhpcy5kaXN0YW5jZSApO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC5zY2FsZS5zZXQoIGQgKiBzY2FsZU11dGlwbGllciAvIDIsIGQgKiBzY2FsZU11dGlwbGllciAvIDIsIGQgKiBzY2FsZU11dGlwbGllciApO1xuXG4gICAgICAgICAgICAgICAgdmFyIHIgPSB0b1JhZCggMTgwICk7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLnJvdGF0aW9uLnggPSBXLnJhbmRvbUJldHdlZW4oIC1yLCByICk7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLnJvdGF0aW9uLnkgPSBXLnJhbmRvbUJldHdlZW4oIC1yLCByICk7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLnJvdGF0aW9uLnogPSBXLnJhbmRvbUJldHdlZW4oIC1yLCByICk7XG5cbiAgICAgICAgICAgICAgICB2YXIgb2ZmZXN0ID0gMC4yO1xuICAgICAgICAgICAgICAgIHRoaXMuYW5jaG9yLnJvdGF0aW9uLnggKz0gIFcucmFuZG9tQmV0d2VlbiggLXRvUmFkKDIwKSwgdG9SYWQoMjApICApO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5yb3RhdGlvblNwZWVkID0gWyBNYXRoLnJhbmRvbSgpLCBNYXRoLnJhbmRvbSgpLCBNYXRoLnJhbmRvbSgpIF0ubWFwKCBNYXRoLmFicyApO1xuXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gdG9SYWQgKCB2ICkgeyByZXR1cm4gdiAqIDAuMDE3NDUzMjkyNTsgfSBcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gIyMjIFN0YXRpY1xuICAgICAgICAgICAgUGFydGljbGUubWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoIHtcbiAgICAgICAgICAgICAgICBjb2xvcjogMHhmZmZmZmYsXG4gICAgICAgICAgICAgICAgc2hpbmluZXNzOiAwLjAsXG4gICAgICAgICAgICAgICAgc3BlY3VsYXI6IDB4ZmZmZmZmLFxuICAgICAgICAgICAgICAgIGVudk1hcDogdml6LmN1YmVDYW1lcmEucmVuZGVyVGFyZ2V0LFxuICAgICAgICAgICAgICAgIHJlZmxlY3Rpdml0eTogMS4wLFxuICAgICAgICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyAjIyMgTWV0aG9kXG4gICAgICAgICAgICBQYXJ0aWNsZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCBkZWx0YU1TLCB0aW1lc3RhbXBNUyApIHtcblxuICAgICAgICAgICAgICAgIHRoaXMudmVsb2NpdHlbIDAgXSArPSAoIHZpei52ZWxvY2l0eVsgMCBdIC0gdGhpcy52ZWxvY2l0eVsgMCBdICkgKiAoIDEgLSB0aGlzLmRpc3RhbmNlICkgKiAwLjA1O1xuICAgICAgICAgICAgICAgIHRoaXMudmVsb2NpdHlbIDEgXSArPSAoIHZpei52ZWxvY2l0eVsgMSBdIC0gdGhpcy52ZWxvY2l0eVsgMSBdICkgKiAoIDEgLSB0aGlzLmRpc3RhbmNlICkgKiAwLjA1O1xuICAgICAgICAgICAgICAgIHRoaXMudmVsb2NpdHlbIDIgXSArPSAoIHZpei52ZWxvY2l0eVsgMiBdIC0gdGhpcy52ZWxvY2l0eVsgMiBdICkgKiAoIDEgLSB0aGlzLmRpc3RhbmNlICkgKiAwLjA1O1xuXG4gICAgICAgICAgICAgICAgdGhpcy5hbmNob3Iucm90YXRpb24ueCArPSB0aGlzLnZlbG9jaXR5WyAwIF0gKiAwLjQ7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmNob3Iucm90YXRpb24ueSArPSB0aGlzLnZlbG9jaXR5WyAxIF0gKiAwLjQ7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmNob3Iucm90YXRpb24ueiArPSB0aGlzLnZlbG9jaXR5WyAyIF0gKiAwLjQ7XG5cbiAgICAgICAgICAgICAgICB2YXIgciA9IE1hdGgubWF4KCB0aGlzLnZlbG9jaXR5WyAwIF0sIHRoaXMudmVsb2NpdHlbIDEgXSwgdGhpcy52ZWxvY2l0eVsgMiBdICk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLm1lc2gucm90YXRpb24ueCArPSAwLjAxICogdGhpcy5yb3RhdGlvblNwZWVkWyAwIF07IC8vIHIgKiB0aGlzLnJvdGF0aW9uU3BlZWRbIDAgXSAqIDEwO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC5yb3RhdGlvbi55ICs9IDAuMDEgKiB0aGlzLnJvdGF0aW9uU3BlZWRbIDEgXSA7IC8vciAqIHRoaXMucm90YXRpb25TcGVlZFsgMSBdICogMTA7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLnJvdGF0aW9uLnogKz0gMC4wMSAqIHRoaXMucm90YXRpb25TcGVlZFsgMiBdOyAvL3IgKiB0aGlzLnJvdGF0aW9uU3BlZWRbIDIgXSAqIDEwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBMb2FkZXJcbiAgICAgICAgICAgIC8vIC0tLS0tLVxuICAgICAgICAgICAgdmFyIGxvYWRlciA9IG5ldyBUSFJFRS5PQkpMb2FkZXIoKTtcbiAgICAgICAgICAgIGxvYWRlci5sb2FkKCAnL29iai9waWxsb3ctYm94Lm9iaicsIG9uT2JqTG9hZGVkICk7XG5cbiAgICAgICAgICAgIC8vIFN3YXJtIENyZWF0aW9uXG4gICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBmdW5jdGlvbiBvbk9iakxvYWRlZCAoIG9iaiApIHtcblxuICAgICAgICAgICAgICAgIHZhciBtZXNoID0gb2JqLmNoaWxkcmVuWyAwIF07XG5cbiAgICAgICAgICAgICAgICAvLyBQYXJ0aWNsZSBDcmVhdGlvblxuICAgICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgLy8gRWFzZSBpbiB0aGUgY3JlYXRpb24gb2YgdGhlIHBhcnRpY2xlc1xuICAgICAgICAgICAgICAgIHZhciBtYXhQYXJ0aWNsZXMgPSAxMjA7XG4gICAgICAgICAgICAgICAgdmFyIG1pbkNyZWF0aW9uVGltZSA9IDU7XG4gICAgICAgICAgICAgICAgdmFyIG1heENyZWF0aW9uVGltZU1TID0gMjA7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgKGZ1bmN0aW9uIGNyZWF0ZU1vcmUgKCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIHBhcnRpY2xlcy5sZW5ndGggPCBtYXhQYXJ0aWNsZXMgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydGljbGUgPSBuZXcgUGFydGljbGUoIG1lc2ggKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpei5zd2FybU9iamVjdDNELmFkZCggcGFydGljbGUuYW5jaG9yICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJ0aWNsZXMucHVzaCggcGFydGljbGUgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoIGNyZWF0ZU1vcmUsIFcubWFwKCBwYXJ0aWNsZXMubGVuZ3RoIC8gbWF4UGFydGljbGVzLCAwLCAxLCBtYXhDcmVhdGlvblRpbWVNUywgbWluQ3JlYXRpb25UaW1lLCBXLmludGVycG9sYXRpb25zLmVhc2VJbiApICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXNvbHZlKCB2aXogKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUmVuZGVyIExvb3BcbiAgICAvLyAtLS0tLS0tLS0tLVxuICAgIGZ1bmN0aW9uIG1ha2VSZW5kZXJMb29wICggdml6ICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcblxuICAgICAgICAgICAgdmFyIGxhc3RUaW1lc3RhbXBNUyA9IDA7XG4gICAgICAgICAgICB2YXIgZGVsdGFNUyA9IDA7XG5cbiAgICAgICAgICAgIChmdW5jdGlvbiAgbG9vcCAoIGN1cnJlbnRUaW1lc3RhbXBNUyApIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZWN1clxuICAgICAgICAgICAgICAgIC8vIC0tLS0tXG4gICAgICAgICAgICAgICAgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSggbG9vcCApO1xuXG4gICAgICAgICAgICAgICAgLy8gVXBkYXRlIHRpbWVzdGFtcHNcbiAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgICBkZWx0YU1TID0gY3VycmVudFRpbWVzdGFtcE1TIC0gbGFzdFRpbWVzdGFtcE1TO1xuICAgICAgICAgICAgICAgIGxhc3RUaW1lc3RhbXBNUyA9IGN1cnJlbnRUaW1lc3RhbXBNUztcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBBY3Rpb25hYmxlc1xuICAgICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgdml6LnByZVJlbmRlckZucy5mb3JFYWNoKCBmbiA9PiBmbiggZGVsdGFNUywgY3VycmVudFRpbWVzdGFtcE1TICkgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBSZW5kZXJcbiAgICAgICAgICAgICAgICAvLyAtLS0tLS1cbiAgICAgICAgICAgICAgICB2aXoucmVuZGVyZXIucmVuZGVyKCB2aXouc2NlbmUsIHZpei5jYW1lcmEgKTtcblxuICAgICAgICAgICAgfSggbGFzdFRpbWVzdGFtcE1TICkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXNvbHZlKCB2aXogKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICAvLyBVdGlsc1xuICAgIC8vID09PT09XG5cbiAgICAvLyBSZW5kZXIgTG9vcFxuICAgIC8vIC0tLS0tLS0tLS0tXG4gICAgZnVuY3Rpb24gYWRkUHJlUmVuZGVyRm4gKCB2aXosIGZuICkge1xuICAgICAgICB2aXoucHJlUmVuZGVyRm5zLnB1c2goIGZuICk7XG4gICAgICAgIHJldHVybiB2aXo7XG4gICAgfVxuXG4gICAgLy8gQ2FtZXJhXG4gICAgLy8gLS0tLS0tXG4gICAgZnVuY3Rpb24gc2V0Q2FtZXJhUG9zaXRpb24gKCB2aXosIHgsIHksIHogKSB7XG4gICAgICAgIHZpei5jYW1lcmEucG9zaXRpb24ueCA9IHg7XG4gICAgICAgIHZpei5jYW1lcmEucG9zaXRpb24ueSA9IHk7XG4gICAgICAgIHZpei5jYW1lcmEucG9zaXRpb24ueiA9IHo7XG4gICAgICAgIHJldHVybiB2aXo7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc2V0VmVsb2NpdHkgKCB2aXosIHgsIHksIHogKSB7XG4gICAgICAgIGlmICggVy5pc0RlZmluZWQoIHggKSAmJiB4ICE9PSBudWxsICkgeyB2aXoudmVsb2NpdHlbIDAgXSA9IHg7IH1cbiAgICAgICAgaWYgKCBXLmlzRGVmaW5lZCggeSApICYmIHkgIT09IG51bGwgKSB7IHZpei52ZWxvY2l0eVsgMSBdID0geTsgfVxuICAgICAgICBpZiAoIFcuaXNEZWZpbmVkKCB6ICkgJiYgeiAhPT0gbnVsbCApIHsgdml6LnZlbG9jaXR5WyAyIF0gPSB6OyB9XG4gICAgICAgIHJldHVybiB2aXo7XG4gICAgfVxuICAgIFxuICAgIC8vIEV4cG9ydFxuICAgIC8vID09PT09PSAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBtYWtlVml6OiBtYWtlVml6LFxuICAgICAgICBpbml0Vml6OiBpbml0Vml6LFxuICAgICAgICBzZXRWZWxvY2l0eTogc2V0VmVsb2NpdHlcbiAgICB9O1xuICAgIFxufSgpKTtcblxuXG5cblxuXG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==