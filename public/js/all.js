"use strict";function makeWebSocketClient(e){return W.promise(function(n,t){e.wsClient=new W.JSONSocketConnection({socketUrl:e.wsUrl});var r=once(function(){report("CONNECTED","to:",e.wsUrl),n(e)});e.wsClient.on("open",r),e.wsClient.on("error",makeReporter("Web Socket Error")),e.wsClient.openSocketConnection()})}function makePunterVizs(e){return W.promise(function(n,t){$("[data-punter-viz]").toArray().map(function(n){e.punterViz=PunterViz.makeApp(),e.punterViz.containerEl=n,PunterViz.initApp(e.punterViz).error(function(e){console.error("Failed to create Punter app",e)}).success(function(e){console.log("Punter application made")})}),n(e)})}function makeRestRadioButtons(e){return W.promise(function(n,t){$('[data-rest-type="radio-post"]').toArray().map($).map(function(n){var t=n.parent();t.on("click touchend",function(t){return t.preventDefault(),console.log("sending",n.val(),"to",n.data("restUri")),RestesqueUtil.post(e.wsClient,n.data("restUri"),n.val()),!1})}),$('[data-rest-type="feildset"]').toArray().map($).map(function(n){var t=n.find('input[type="radio"]').checkboxradio();console.log("got a field set",n.data("restUri")),RestesqueUtil.subscribeWithInitialGet(e.wsClient,n.data("restUri"),function(e){t.prop("checked",!1).checkboxradio("refresh").filter('input[value="'+e.getBody()+'"]').attr("checked","checked").checkboxradio("refresh").parent().find("label").removeClass("ui-radio-off").addClass("ui-radio-on")})}),n(e)})}function once(e){var n=!1;return function(){n||(e(),n=!0)}}function report(e,n){console.log("[",e,"]",W.rest(W.toArray(arguments)).join(" "))}function makeReporter(e,n){var t=arguments;return function(){report.apply(this,t);var e=arguments;return W.promise(function(n,t){n.apply(this,e)})}}var PunterViz=function(){function e(){return{containerEl:document.createElement("div"),backroundColor:6382180,preRenderFns:[],preCubeCamRenderFns:[],postCubeCamRenderFns:[]}}function n(e){return W.promise(function(n,t){e.camera=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,3e3),u(e,0,0,200),e.scene=new THREE.Scene,e.renderer=new THREE.WebGLRenderer({antialias:!1}),e.renderer.setPixelRatio(window.devicePixelRatio),e.renderer.setSize(window.innerWidth,window.innerHeight),e.renderer.setClearColor(e.backgroundColor),e.renderer.sortObjects=!1,e.containerEl.appendChild(e.renderer.domElement),n(e)})}function t(e){return W.promise(function(n,t){var r=document.createElement("video");r.autoplay=!0,navigator.webkitGetUserMedia({video:!0},function(e){r.src=URL.createObjectURL(e)},function(e){console.log("Failed to get a stream due to",e)}),e.webCamTexture=new THREE.Texture(r),e.webCamTexture.minFilter=THREE.LinearFilter,c(e,function(n,t){r.readyState===r.HAVE_ENOUGH_DATA&&(e.webCamTexture.needsUpdate=!0)}),n(e)})}function r(e){return W.promise(function(n,t){e.cubeCamera=new THREE.CubeCamera(1,3e3,256),e.cubeCamera.renderTarget.minFilter=THREE.LinearMipMapLinearFilter,c(e,function(n,t){e.preCubeCamRenderFns.forEach(function(e){return e(n,t)}),e.cubeCamera.updateCubeMap(e.renderer,e.scene),e.postCubeCamRenderFns.forEach(function(e){return e(n,t)})}),n(e)})}function i(e){return W.promise(function(n,t){var r=new THREE.MeshBasicMaterial({map:e.webCamTexture,color:16777215,side:THREE.BackSide});e.webCamvBoxMesh=new THREE.Mesh(new THREE.BoxGeometry(2e3,2e3,2e3),r);var i=W.randomBetween(2e-4,2e-5),o=W.randomBetween(2e-4,2e-5),a=W.randomBetween(2e-4,2e-5);c(e,function(n,t){e.webCamvBoxMesh.rotation.x+=n*i,e.webCamvBoxMesh.rotation.y+=n*o,e.webCamvBoxMesh.rotation.z+=n*a}),e.scene.add(e.webCamvBoxMesh),e.preCubeCamRenderFns.push(function(){e.webCamvBoxMesh.visible=!0}),e.postCubeCamRenderFns.push(function(){e.webCamvBoxMesh.visible=!1}),n(e)})}function o(e){return W.promise(function(n,t){e.scene.add(new THREE.AmbientLight(2236962));var r=new THREE.DirectionalLight(16777215,2);r.position.set(2,1.2,10).normalize(),e.scene.add(r),r=new THREE.DirectionalLight(16777215,1),r.position.set(-2,1.2,-10).normalize(),e.scene.add(r),n(e)})}function a(e){return W.promise(function(n,t){function r(n){{var t=n.children[0],r=100,a=5,s=100;!function c(){if(o.length<r){var n=new i(t);e.swarmObject3D.add(n.anchor),o.push(n),setTimeout(c,W.map(o.length/r,0,1,s,a,W.interpolations.easeIn))}}()}}function i(e){this.velocity=W.randomBetween(.2,1),this.mesh=e.clone(),this.mesh.material=i.material.clone(),this.mesh.scale.x=i.initialScale,this.mesh.scale.y=i.initialScale,this.mesh.scale.z=i.initialScale;var n=100;this.mesh.position.set((Math.random()-.5)*n,(Math.random()-.5)*n,(Math.random()-.5)*n),this.anchor=new THREE.Object3D,this.anchor.add(this.mesh)}var o=[];e.swarmObject3D=new THREE.Object3D,e.scene.add(e.swarmObject3D),e.preCubeCamRenderFns.push(function(){e.swarmObject3D.visible=!1}),e.postCubeCamRenderFns.push(function(){e.swarmObject3D.visible=!0});var a=new THREE.OBJLoader;a.load("/obj/pillow-box.obj",r),c(e,function(e,n){o.forEach(function(t){return t.update(e,n)})}),i.material=new THREE.MeshPhongMaterial({color:16777215,shininess:0,specular:16777215,envMap:e.cubeCamera.renderTarget,reflectivity:1,side:THREE.DoubleSide}),i.initialScale=200,i.prototype.update=function(e,n){this.anchor.rotation.x+=.002,this.anchor.rotation.y+=this.velocity/10,this.anchor.rotation.z+=.001},n(e)})}function s(e){return W.promise(function(n,t){var r=0,i=0;!function o(n){window.requestAnimationFrame(o),i=n-r,r=n,e.preRenderFns.forEach(function(e){return e(i,n)}),e.renderer.clear(),e.renderer.render(e.scene,e.camera)}(r),n(e)})}function c(e,n){e.preRenderFns.push(n)}function u(e,n,t,r){e.camera.position.x=n,e.camera.position.y=t,e.camera.position.z=r}var d=W.composePromisers(n,t,r,i,a,o,s);return{makeApp:e,initApp:d}}(),makeApp=function(){return{wsUrl:"wss://192.168.0.7:7080"}},initApp=W.composePromisers(makeWebSocketClient,makePunterVizs,makeRestRadioButtons);$(function(){initApp(makeApp()).success(function(e){report("OK","TheWorkers.net"),window.app=e})});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFsbC5qcyIsIm1haW4uanMiLCJwdW50ZXItdml6LmpzIl0sIm5hbWVzIjpbIm1ha2VXZWJTb2NrZXRDbGllbnQiLCJhcHAiLCJXIiwicHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ3c0NsaWVudCIsIkpTT05Tb2NrZXRDb25uZWN0aW9uIiwic29ja2V0VXJsIiwid3NVcmwiLCJyZXNvbHZlT25GaXJzdENvbm5lY3QiLCJvbmNlIiwicmVwb3J0Iiwib24iLCJtYWtlUmVwb3J0ZXIiLCJvcGVuU29ja2V0Q29ubmVjdGlvbiIsIm1ha2VQdW50ZXJWaXpzIiwiJCIsInRvQXJyYXkiLCJtYXAiLCJlbCIsInB1bnRlclZpeiIsIlB1bnRlclZpeiIsIm1ha2VBcHAiLCJjb250YWluZXJFbCIsImluaXRBcHAiLCJlcnJvciIsImVyciIsImNvbnNvbGUiLCJzdWNjZXNzIiwiaW5pdGFsaXNlZFB1bnRlckFwcCIsImxvZyIsIm1ha2VSZXN0UmFkaW9CdXR0b25zIiwiJGVsIiwiJHdyYXBwZXJFbCIsInBhcmVudCIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInZhbCIsImRhdGEiLCJSZXN0ZXNxdWVVdGlsIiwicG9zdCIsInJhZGlvRWxzIiwiZmluZCIsImNoZWNrYm94cmFkaW8iLCJzdWJzY3JpYmVXaXRoSW5pdGlhbEdldCIsInBhY2tldCIsInByb3AiLCJmaWx0ZXIiLCJnZXRCb2R5IiwiYXR0ciIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJmbiIsImhhc1RyaWdnZXJlZCIsInN0YXR1cyIsInN0ciIsInJlc3QiLCJhcmd1bWVudHMiLCJqb2luIiwicmVwb3J0QXJncyIsImFwcGx5IiwidGhpcyIsImNhbGxlZUFyZ3MiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJiYWNrcm91bmRDb2xvciIsInByZVJlbmRlckZucyIsInByZUN1YmVDYW1SZW5kZXJGbnMiLCJwb3N0Q3ViZUNhbVJlbmRlckZucyIsIm1ha2VDYW1lcmFTY2VuZVJlbmRlcmVyIiwiY2FtZXJhIiwiVEhSRUUiLCJQZXJzcGVjdGl2ZUNhbWVyYSIsIndpbmRvdyIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsInNldENhbWVyYVBvc2l0aW9uIiwic2NlbmUiLCJTY2VuZSIsInJlbmRlcmVyIiwiV2ViR0xSZW5kZXJlciIsImFudGlhbGlhcyIsInNldFBpeGVsUmF0aW8iLCJkZXZpY2VQaXhlbFJhdGlvIiwic2V0U2l6ZSIsInNldENsZWFyQ29sb3IiLCJiYWNrZ3JvdW5kQ29sb3IiLCJzb3J0T2JqZWN0cyIsImFwcGVuZENoaWxkIiwiZG9tRWxlbWVudCIsIm1ha2VXZWJDYW1UZXh0dXJlIiwid2ViQ2FtRWwiLCJhdXRvcGxheSIsIm5hdmlnYXRvciIsIndlYmtpdEdldFVzZXJNZWRpYSIsInZpZGVvIiwic3RyZWFtIiwic3JjIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwid2ViQ2FtVGV4dHVyZSIsIlRleHR1cmUiLCJtaW5GaWx0ZXIiLCJMaW5lYXJGaWx0ZXIiLCJhZGRQcmVSZW5kZXJGbiIsImRldGxhTVMiLCJ0aW1lc3RhbXBNUyIsInJlYWR5U3RhdGUiLCJIQVZFX0VOT1VHSF9EQVRBIiwibmVlZHNVcGRhdGUiLCJtYWtlQ3ViZUNhbSIsImN1YmVDYW1lcmEiLCJDdWJlQ2FtZXJhIiwicmVuZGVyVGFyZ2V0IiwiTGluZWFyTWlwTWFwTGluZWFyRmlsdGVyIiwiZGVsdGFNUyIsImZvckVhY2giLCJ1cGRhdGVDdWJlTWFwIiwibWFrZVdlYkNhbUJveE1lc2giLCJ3ZWJDYW1Cb3hNYXRlcmlhbCIsIk1lc2hCYXNpY01hdGVyaWFsIiwiY29sb3IiLCJzaWRlIiwiQmFja1NpZGUiLCJ3ZWJDYW12Qm94TWVzaCIsIk1lc2giLCJCb3hHZW9tZXRyeSIsInJvdGF0aW9uWCIsInJhbmRvbUJldHdlZW4iLCJyb3RhdGlvblkiLCJyb3RhdGlvbloiLCJyb3RhdGlvbiIsIngiLCJ5IiwieiIsImFkZCIsInB1c2giLCJ2aXNpYmxlIiwibWFrZUxpZ2h0cyIsIkFtYmllbnRMaWdodCIsImRpcmVjdGlvbmFsTGlnaHQiLCJEaXJlY3Rpb25hbExpZ2h0IiwicG9zaXRpb24iLCJzZXQiLCJub3JtYWxpemUiLCJtYWtlU3dhcm0iLCJvbk9iakxvYWRlZCIsIm9iaiIsIm1lc2giLCJjaGlsZHJlbiIsIm1heFBhcnRpY2xlcyIsIm1pbkNyZWF0aW9uVGltZSIsIm1heENyZWF0aW9uVGltZU1TIiwiY3JlYXRlTW9yZSIsInBhcnRpY2xlcyIsImxlbmd0aCIsInBhcnRpY2xlIiwiUGFydGljbGUiLCJzd2FybU9iamVjdDNEIiwiYW5jaG9yIiwic2V0VGltZW91dCIsImludGVycG9sYXRpb25zIiwiZWFzZUluIiwidmVsb2NpdHkiLCJjbG9uZSIsIm1hdGVyaWFsIiwic2NhbGUiLCJpbml0aWFsU2NhbGUiLCJyYW5nZSIsIk1hdGgiLCJyYW5kb20iLCJPYmplY3QzRCIsImxvYWRlciIsIk9CSkxvYWRlciIsImxvYWQiLCJ1cGRhdGUiLCJNZXNoUGhvbmdNYXRlcmlhbCIsInNoaW5pbmVzcyIsInNwZWN1bGFyIiwiZW52TWFwIiwicmVmbGVjdGl2aXR5IiwiRG91YmxlU2lkZSIsInByb3RvdHlwZSIsIm1ha2VSZW5kZXJMb29wIiwibGFzdFRpbWVzdGFtcE1TIiwibG9vcCIsImN1cnJlbnRUaW1lc3RhbXBNUyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImNsZWFyIiwicmVuZGVyIiwiY29tcG9zZVByb21pc2VycyJdLCJtYXBwaW5ncyI6IkFBUUEsWUNzQkEsU0FBU0EscUJBQXNCQyxHQUMzQixNQUFPQyxHQUFFQyxRQUFTLFNBQVdDLEVBQVNDLEdBQ2xDSixFQUFJSyxTQUFXLEdBQUlKLEdBQUVLLHNCQUNqQkMsVUFBV1AsRUFBSVEsT0FHbkIsSUFBSUMsR0FBd0JDLEtBQU0sV0FDOUJDLE9BQVEsWUFBYSxNQUFPWCxFQUFJUSxPQUNoQ0wsRUFBU0gsSUFHYkEsR0FBSUssU0FBU08sR0FBSSxPQUFRSCxHQUN6QlQsRUFBSUssU0FBU08sR0FBSSxRQUFTQyxhQUFjLHFCQUN4Q2IsRUFBSUssU0FBU1MseUJB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RUFDeEJySSxFQUFJc0UsT0FBT3dFLFNBQVNSLEVBQUlBLEVBaFQ1QixHQUFJOUcsR0FBVXZCLEVBQUU2TCxpQkFBa0J6SCxFQUNBcUIsRUFDQW9CLEVBQ0FRLEVBQ0EyQixFQUNBUCxFQUNBNkMsRUErU2xDLFFBQ0lqSyxRQUFTQSxFQUNURSxRQUFTQSxNRHBVYkYsUUFBVSxXQUNWLE9BQ0lkLE1BQU8sMkJBSVhnQixRQUFVdkIsRUFBRTZMLGlCQUFrQi9MLG9CQUNBZ0IsZUFDQWdCLHFCQUVsQ2YsR0FBRyxXQUNDUSxRQUFTRixXQUNSTSxRQUFTLFNBQVc1QixHQUNqQlcsT0FBUSxLQUFNLGtCQUNkOEQsT0FBT3pFLElBQU1BIiwiZmlsZSI6ImFsbC5qcyIsInNvdXJjZXNDb250ZW50IjpbbnVsbCwiLyoganNoaW50IGVzbmV4dDogdHJ1ZSAqL1xuXG4vLyBNYWluLmpzXG4vLyA9PT09PT09XG4vLyBFbnRyeSBwb2ludCBvZiB0aGUgYXBwbGljYXRpb24uXG5cbi8vIE1ha2UgJiBJbml0XG4vLyA9PT09PT09PT09PVxuXG52YXIgbWFrZUFwcCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB3c1VybDogJ3dzczovLzE5Mi4xNjguMC43OjcwODAnXG4gICAgfTtcbn07XG5cbnZhciBpbml0QXBwID0gVy5jb21wb3NlUHJvbWlzZXJzKCBtYWtlV2ViU29ja2V0Q2xpZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VQdW50ZXJWaXpzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VSZXN0UmFkaW9CdXR0b25zICk7XG5cbiQoIGZ1bmN0aW9uICgpIHtcbiAgICBpbml0QXBwKCBtYWtlQXBwKCkgKVxuICAgIC5zdWNjZXNzKCBmdW5jdGlvbiAoIGFwcCApIHtcbiAgICAgICAgcmVwb3J0KCAnT0snLCAnVGhlV29ya2Vycy5uZXQnICk7XG4gICAgICAgIHdpbmRvdy5hcHAgPSBhcHA7XG4gICAgfSk7XG59KTtcblxuLy8gUHJvbWlzZXJzXG4vLyA9PT09PT09PT1cblxuZnVuY3Rpb24gbWFrZVdlYlNvY2tldENsaWVudCAoIGFwcCApIHtcbiAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgYXBwLndzQ2xpZW50ID0gbmV3IFcuSlNPTlNvY2tldENvbm5lY3Rpb24oe1xuICAgICAgICAgICAgc29ja2V0VXJsOiBhcHAud3NVcmxcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVzb2x2ZU9uRmlyc3RDb25uZWN0ID0gb25jZSggZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmVwb3J0KCAnQ09OTkVDVEVEJywgJ3RvOicsIGFwcC53c1VybCApO1xuICAgICAgICAgICAgcmVzb2x2ZSggYXBwICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGFwcC53c0NsaWVudC5vbiggJ29wZW4nLCByZXNvbHZlT25GaXJzdENvbm5lY3QgKTtcbiAgICAgICAgYXBwLndzQ2xpZW50Lm9uKCAnZXJyb3InLCBtYWtlUmVwb3J0ZXIoICdXZWIgU29ja2V0IEVycm9yJyApICk7XG4gICAgICAgIGFwcC53c0NsaWVudC5vcGVuU29ja2V0Q29ubmVjdGlvbigpO1xuICAgICAgICBcbiAgICB9KTtcbn1cblxuLy8gUHVudGVyIFZpelxuLy8gLS0tLS0tLS0tLVxuXG5mdW5jdGlvbiBtYWtlUHVudGVyVml6cyAoIGFwcCApIHtcbiAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgJCggXCJbZGF0YS1wdW50ZXItdml6XVwiIClcbiAgICAgICAgICAgIC50b0FycmF5KClcbiAgICAgICAgICAgIC5tYXAoIGZ1bmN0aW9uICggZWwgKSB7XG4gICAgICAgICAgICAgICAgLy8gTWFrZSB0aGUgcHVudGVyIGFwcGxpY2F0aW9uXG4gICAgICAgICAgICAgICAgYXBwLnB1bnRlclZpeiA9IFB1bnRlclZpei5tYWtlQXBwKCk7XG4gICAgICAgICAgICAgICAgLy8gQWRkIG91dCBkb20gZWxlbWVudFxuICAgICAgICAgICAgICAgIGFwcC5wdW50ZXJWaXouY29udGFpbmVyRWwgPSBlbDtcblxuICAgICAgICAgICAgICAgIC8vIEluaXRhaWxpc2UgaXRcbiAgICAgICAgICAgICAgICBQdW50ZXJWaXpcbiAgICAgICAgICAgICAgICAgICAgLmluaXRBcHAoIGFwcC5wdW50ZXJWaXogKVxuICAgICAgICAgICAgICAgICAgICAuZXJyb3IoIGZ1bmN0aW9uICggZXJyICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvciggJ0ZhaWxlZCB0byBjcmVhdGUgUHVudGVyIGFwcCcsIGVyciApO1xuICAgICAgICAgICAgICAgICAgICB9KSBcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoIGZ1bmN0aW9uICggaW5pdGFsaXNlZFB1bnRlckFwcCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnUHVudGVyIGFwcGxpY2F0aW9uIG1hZGUnICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgcmVzb2x2ZSggYXBwICk7XG4gICAgfSk7XG59XG5cbi8vIGpRdWVyeSBNb2JpbGUgVWkgQmluZGluZ3Ncbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuZnVuY3Rpb24gbWFrZVJlc3RSYWRpb0J1dHRvbnMgKCBhcHAgKSB7XG4gICAgcmV0dXJuIFcucHJvbWlzZSggZnVuY3Rpb24gKCByZXNvbHZlLCByZWplY3QgKSB7XG4gICAgICAgIC8vIFJhZGlvIEJ1dHRvbnNcbiAgICAgICAgLy8gPT09PT09PT09PT09PVxuICAgICAgICAkKCAnW2RhdGEtcmVzdC10eXBlPVwicmFkaW8tcG9zdFwiXScgKVxuICAgICAgICAgICAgLnRvQXJyYXkoKVxuICAgICAgICAgICAgLm1hcCggJCApXG4gICAgICAgICAgICAubWFwKCBmdW5jdGlvbiAoICRlbCApIHtcbiAgICAgICAgICAgICAgICAvLyBEaXNhYmxlIHJlYWwgZXZlbnRzXG4gICAgICAgICAgICAgICAgdmFyICR3cmFwcGVyRWwgPSAkZWwucGFyZW50KCk7XG4gICAgICAgICAgICAgICAgJHdyYXBwZXJFbC5vbiggJ2NsaWNrIHRvdWNoZW5kJywgZnVuY3Rpb24gKCBlICkge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAnc2VuZGluZycsJGVsLnZhbCgpLCAndG8nLCAkZWwuZGF0YSggJ3Jlc3RVcmknICkgICk7XG4gICAgICAgICAgICAgICAgICAgIFJlc3Rlc3F1ZVV0aWwucG9zdCggYXBwLndzQ2xpZW50LCAkZWwuZGF0YSggJ3Jlc3RVcmknICksICRlbC52YWwoKSApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAvLyBSYWRpbyBGaWVsZCBTZXRzXG4gICAgICAgIC8vID09PT09PT09PT09PT09PT1cbiAgICAgICAgJCggJ1tkYXRhLXJlc3QtdHlwZT1cImZlaWxkc2V0XCJdJyApXG4gICAgICAgICAgICAudG9BcnJheSgpXG4gICAgICAgICAgICAubWFwKCAkIClcbiAgICAgICAgICAgIC5tYXAoIGZ1bmN0aW9uICggJGVsICkge1xuXG4gICAgICAgICAgICAgICAgdmFyIHJhZGlvRWxzID0gJGVsLmZpbmQoICdpbnB1dFt0eXBlPVwicmFkaW9cIl0nICkuY2hlY2tib3hyYWRpbygpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCAgJ2dvdCBhIGZpZWxkIHNldCcsICRlbC5kYXRhKCAncmVzdFVyaScgKSApO1xuICAgICAgICAgICAgICAgIFJlc3Rlc3F1ZVV0aWwuc3Vic2NyaWJlV2l0aEluaXRpYWxHZXQoIGFwcC53c0NsaWVudCwgJGVsLmRhdGEoICdyZXN0VXJpJyApLCBmdW5jdGlvbiAoIHBhY2tldCApIHtcbiAgICAgICAgICAgICAgICAgICAgcmFkaW9FbHNcbiAgICAgICAgICAgICAgICAgICAgICAgIC5wcm9wKCAnY2hlY2tlZCcsIGZhbHNlIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jaGVja2JveHJhZGlvKCAncmVmcmVzaCcgKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlciggJ2lucHV0W3ZhbHVlPVwiJysgcGFja2V0LmdldEJvZHkoKSArJ1wiXScgKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoICdjaGVja2VkJywgJ2NoZWNrZWQnIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5jaGVja2JveHJhZGlvKCAncmVmcmVzaCcgKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnBhcmVudCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmluZCggJ2xhYmVsJyApXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQ2xhc3MoICd1aS1yYWRpby1vZmYnIClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hZGRDbGFzcyggJ3VpLXJhZGlvLW9uJyApO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICByZXNvbHZlKCBhcHAgKTtcbiAgICB9KTtcbn1cblxuLy8gVXRpbHNcbi8vID09PT09XG5cbi8vIEZ1bmN0aW9uXG4vLyAtLS0tLS0tLVxuICAgIFxuZnVuY3Rpb24gb25jZSAoIGZuICkge1xuICAgIHZhciBoYXNUcmlnZ2VyZWQgPSBmYWxzZTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoICEgaGFzVHJpZ2dlcmVkICkge1xuICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICAgIGhhc1RyaWdnZXJlZCA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vLyBSZXBvcnRpbmdcbi8vIC0tLS0tLS0tLVxuXG5mdW5jdGlvbiByZXBvcnQoIHN0YXR1cywgc3RyICkge1xuICAgIGNvbnNvbGUubG9nKCAnWycsIHN0YXR1cywgJ10nLCBXLnJlc3QoIFcudG9BcnJheSggYXJndW1lbnRzICkgKS5qb2luKCAnICcgKSApO1xufVxuXG5mdW5jdGlvbiBtYWtlUmVwb3J0ZXIoIHN0YXR1cywgc3RyICkge1xuICAgIHZhciByZXBvcnRBcmdzID0gYXJndW1lbnRzO1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJlcG9ydC5hcHBseSggdGhpcywgcmVwb3J0QXJncyApO1xuICAgICAgICB2YXIgY2FsbGVlQXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgcmV0dXJuIFcucHJvbWlzZSggZnVuY3Rpb24gKCByZXNvbHZlLCByZWplY3QgKSB7XG4gICAgICAgICAgICByZXNvbHZlLmFwcGx5KCB0aGlzLCBjYWxsZWVBcmdzICk7XG4gICAgICAgIH0pO1xuICAgIH07XG59XG4iLCIvKiBqc2hpbnQgZXNuZXh0OiB0cnVlICovXG5cbi8vIFB1bnRlciBWaXpcbi8vID09PT09PT09PT1cbi8vIEEgdGhyZWUuanMgdmlzdWxpc2F0aW9uIHRvIGJlXG4vLyBydW4gb24gYW4gSFRDIHBob25lIGFuZCBjYXJyaWVkIGJ5XG4vLyBwdW50ZXJzIGludG8gdGhlIG1pcnJvciBib3guXG5cbnZhciBQdW50ZXJWaXogPSAoZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gSW5pdCAmIG1ha2VcbiAgICAvLyA9PT09PT09PT09PVxuICAgIGZ1bmN0aW9uIG1ha2VBcHAgKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgY29udGFpbmVyRWw6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdkaXYnICksXG4gICAgICAgICAgICBiYWNrcm91bmRDb2xvcjogMHg2MTYyNjQsXG4gICAgICAgICAgICBwcmVSZW5kZXJGbnM6IFtdLFxuICAgICAgICAgICAgcHJlQ3ViZUNhbVJlbmRlckZuczogW10sXG4gICAgICAgICAgICBwb3N0Q3ViZUNhbVJlbmRlckZuczogW11cbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICB2YXIgaW5pdEFwcCA9IFcuY29tcG9zZVByb21pc2VycyggbWFrZUNhbWVyYVNjZW5lUmVuZGVyZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VXZWJDYW1UZXh0dXJlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYWtlQ3ViZUNhbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVdlYkNhbUJveE1lc2gsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VTd2FybSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZUxpZ2h0cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFrZVJlbmRlckxvb3AgKTtcblxuICAgIC8vIFByb21pc2Vyc1xuICAgIC8vID09PT09PT09PVxuXG4gICAgLy8gQ2FtZXJhLCBTY2VuZSwgUmVuZGVyZXJcbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIGZ1bmN0aW9uIG1ha2VDYW1lcmFTY2VuZVJlbmRlcmVyICggYXBwICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ2FtZXJhXG4gICAgICAgICAgICAvLyAtLS0tLS1cbiAgICAgICAgICAgIGFwcC5jYW1lcmEgPSBuZXcgVEhSRUUuUGVyc3BlY3RpdmVDYW1lcmEoIDcwLCB3aW5kb3cuaW5uZXJXaWR0aCAvIHdpbmRvdy5pbm5lckhlaWdodCwgMSwgMzAwMCApO1xuICAgICAgICAgICAgc2V0Q2FtZXJhUG9zaXRpb24oIGFwcCwgMCwgMCwgMjAwICk7XG5cbiAgICAgICAgICAgIC8vIFNjZW5lXG4gICAgICAgICAgICAvLyAtLS0tLVxuICAgICAgICAgICAgYXBwLnNjZW5lID0gbmV3IFRIUkVFLlNjZW5lKCk7XG5cbiAgICAgICAgICAgIC8vIFJlbmRlcmVyXG4gICAgICAgICAgICAvLyAtLS0tLS0tLVxuICAgICAgICAgICAgYXBwLnJlbmRlcmVyID0gbmV3IFRIUkVFLldlYkdMUmVuZGVyZXIoIHsgYW50aWFsaWFzOiBmYWxzZSB9ICk7XG5cdCAgICBhcHAucmVuZGVyZXIuc2V0UGl4ZWxSYXRpbyggd2luZG93LmRldmljZVBpeGVsUmF0aW8gKTtcblx0ICAgIGFwcC5yZW5kZXJlci5zZXRTaXplKCB3aW5kb3cuaW5uZXJXaWR0aCwgd2luZG93LmlubmVySGVpZ2h0ICk7XG4gICAgICAgICAgICBhcHAucmVuZGVyZXIuc2V0Q2xlYXJDb2xvciggYXBwLmJhY2tncm91bmRDb2xvciApO1xuXHQgICAgYXBwLnJlbmRlcmVyLnNvcnRPYmplY3RzID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGFwcC5jb250YWluZXJFbC5hcHBlbmRDaGlsZCggYXBwLnJlbmRlcmVyLmRvbUVsZW1lbnQgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmVzb2x2ZSggYXBwICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFdlYiBDYW1cbiAgICAvLyAtLS0tLS0tXG4gICAgLy8gTWFrZSB0aGUgd2ViIGNhbSBhdmFpbGFibGUgYXMgYSB0ZXh0dXJlXG4gICAgZnVuY3Rpb24gbWFrZVdlYkNhbVRleHR1cmUgKCBhcHAgKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuXG4gICAgICAgICAgICAvLyBXZWIgQ2FtIERPTSBFbGVtZW50XG4gICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICB2YXIgd2ViQ2FtRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpO1xuICAgICAgICAgICAgd2ViQ2FtRWwuYXV0b3BsYXkgPSB0cnVlO1xuXG4gICAgICAgICAgICAvLyBXZWIgQ2FtIFN0cmVhbVxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgIG5hdmlnYXRvci53ZWJraXRHZXRVc2VyTWVkaWEoIHsgdmlkZW86dHJ1ZSB9LCBmdW5jdGlvbiggc3RyZWFtICl7XG4gICAgICAgICAgICAgICAgd2ViQ2FtRWwuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTCggc3RyZWFtICk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiggZXJyICl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGYWlsZWQgdG8gZ2V0IGEgc3RyZWFtIGR1ZSB0b1wiLCBlcnIpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFdlYiBDYW0gVGV4dHVyZVxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBhcHAud2ViQ2FtVGV4dHVyZSA9IG5ldyBUSFJFRS5UZXh0dXJlKCB3ZWJDYW1FbCApO1xuICAgICAgICAgICAgYXBwLndlYkNhbVRleHR1cmUubWluRmlsdGVyID0gVEhSRUUuTGluZWFyRmlsdGVyO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBSZW5kZXIgVXBkYXRlc1xuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgIGFkZFByZVJlbmRlckZuKCBhcHAsIGZ1bmN0aW9uICggZGV0bGFNUywgdGltZXN0YW1wTVMgKSB7XG4gICAgICAgICAgICAgICAgaWYoIHdlYkNhbUVsLnJlYWR5U3RhdGUgPT09IHdlYkNhbUVsLkhBVkVfRU5PVUdIX0RBVEEgKXtcbiAgICAgICAgICAgICAgICAgICAgYXBwLndlYkNhbVRleHR1cmUubmVlZHNVcGRhdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXNvbHZlKCBhcHAgKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQ3ViZSBDYW1lcmFcbiAgICAvLyAtLS0tLS0tLS0tLVxuICAgIC8vIENyZWF0ZSBhIGN1YmUgY2FtIGZvciBhIGR5bmFtaWMgZW52TWFwLlxuICAgIC8vIFRoaXMgYWxzbyBlbmFibGVzIHR3byBob29rczogYHByZUN1YmVDYW1SZW5kZXJBY3Rpb25zYCAmIGBwb3N0Q3ViZUNhbVJlbmRlckFjdGlvbnNgXG4gICAgLy8gaW4gdGhlIGFwcCBmb3IgdGhhdCBvYmplY3QzRCBpbiB0aGUgc2NlbmUgY2FuIGJlIHR1cm5lZCBvbiBhbmQgb2ZmIGR1cmluZ1xuICAgIC8vIHRoZSB3ZWJjYW1zIHJlbmRlclxuICAgIGZ1bmN0aW9uIG1ha2VDdWJlQ2FtICggYXBwICkgeyBcbiAgICAgICAgcmV0dXJuIFcucHJvbWlzZSggZnVuY3Rpb24gKCByZXNvbHZlLCByZWplY3QgKSB7XG5cbiAgICAgICAgICAgIGFwcC5jdWJlQ2FtZXJhID0gbmV3IFRIUkVFLkN1YmVDYW1lcmEoMSwgMzAwMCwgMjU2KTsgLy8gbmVhciwgZmFyLCByZXNvbHV0aW9uXG4gICAgICAgICAgICBhcHAuY3ViZUNhbWVyYS5yZW5kZXJUYXJnZXQubWluRmlsdGVyID0gVEhSRUUuTGluZWFyTWlwTWFwTGluZWFyRmlsdGVyOyAvLyBtaXBtYXAgZmlsdGVyXG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGFkZFByZVJlbmRlckZuKCBhcHAsIGZ1bmN0aW9uICggZGVsdGFNUywgdGltZXN0YW1wTVMgKSB7ICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlbmRlciB0aGUgY3ViZSBjYW1lcmEgdG8gY3ViZSBtYXBcbiAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgYXBwLnByZUN1YmVDYW1SZW5kZXJGbnMuZm9yRWFjaCggZm4gPT4gZm4oIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkgKTtcbiAgICAgICAgICAgICAgICBhcHAuY3ViZUNhbWVyYS51cGRhdGVDdWJlTWFwKCBhcHAucmVuZGVyZXIsIGFwcC5zY2VuZSApO1xuICAgICAgICAgICAgICAgIGFwcC5wb3N0Q3ViZUNhbVJlbmRlckZucy5mb3JFYWNoKCBmbiA9PiBmbiggZGVsdGFNUywgdGltZXN0YW1wTVMgKSApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBXZWIgQ2FtIEJveCBNZXNoXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIENyZWF0ZXMgYSBib3ggd2l0aCB0aGUgd2ViIGNhbSBkaXNwbGF5ZWRcbiAgICAvLyBvbiB0aGUgaW5zaWRlIG9mIGVhY2ggb2YgaXQncyA2IHNpZGVzXG4gICAgZnVuY3Rpb24gbWFrZVdlYkNhbUJveE1lc2ggKCBhcHAgKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgd2ViQ2FtQm94TWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwoe1xuICAgICAgICAgICAgICAgIG1hcDogYXBwLndlYkNhbVRleHR1cmUsXG4gICAgICAgICAgICAgICAgY29sb3I6IDB4ZmZmZmZmLFxuXHQgICAgICAgIHNpZGU6IFRIUkVFLkJhY2tTaWRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgYXBwLndlYkNhbXZCb3hNZXNoID0gbmV3IFRIUkVFLk1lc2goIG5ldyBUSFJFRS5Cb3hHZW9tZXRyeSggMjAwMCwgMjAwMCwgMjAwMCApLCB3ZWJDYW1Cb3hNYXRlcmlhbCApO1xuXG4gICAgICAgICAgICB2YXIgcm90YXRpb25YID0gVy5yYW5kb21CZXR3ZWVuKCAwLjAwMDIsIDAuMDAwMDIgKTtcbiAgICAgICAgICAgIHZhciByb3RhdGlvblkgPSBXLnJhbmRvbUJldHdlZW4oIDAuMDAwMiwgMC4wMDAwMiApO1xuICAgICAgICAgICAgdmFyIHJvdGF0aW9uWiA9IFcucmFuZG9tQmV0d2VlbiggMC4wMDAyLCAwLjAwMDAyICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIElmIHdlIHdhbnQgdG8gcm90YXRlIGl0XG4gICAgICAgICAgICBhZGRQcmVSZW5kZXJGbiggYXBwLCBmdW5jdGlvbiAoIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkge1xuICAgICAgICAgICAgICAgIGFwcC53ZWJDYW12Qm94TWVzaC5yb3RhdGlvbi54ICs9ICggZGVsdGFNUyAqIHJvdGF0aW9uWCApO1xuICAgICAgICAgICAgICAgIGFwcC53ZWJDYW12Qm94TWVzaC5yb3RhdGlvbi55ICs9ICggZGVsdGFNUyAqIHJvdGF0aW9uWSApO1xuICAgICAgICAgICAgICAgIGFwcC53ZWJDYW12Qm94TWVzaC5yb3RhdGlvbi56ICs9ICggZGVsdGFNUyAqIHJvdGF0aW9uWiApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcblx0ICAgIGFwcC5zY2VuZS5hZGQoIGFwcC53ZWJDYW12Qm94TWVzaCApO1xuXG4gICAgICAgICAgICAvLyBTaG93IGl0IG9ubHkgZm9yIHRoZSBjdWJlIGNhbVxuICAgICAgICAgICAgYXBwLnByZUN1YmVDYW1SZW5kZXJGbnMucHVzaCggZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGFwcC53ZWJDYW12Qm94TWVzaC52aXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBhcHAucG9zdEN1YmVDYW1SZW5kZXJGbnMucHVzaCggZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGFwcC53ZWJDYW12Qm94TWVzaC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgXG5cbiAgICAgICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBMaWdodHNcbiAgICAvLyAtLS0tLS1cbiAgICBmdW5jdGlvbiBtYWtlTGlnaHRzICggYXBwICkge1xuICAgICAgICByZXR1cm4gVy5wcm9taXNlKCBmdW5jdGlvbiAoIHJlc29sdmUsIHJlamVjdCApIHtcbiAgICAgICAgICAgIGFwcC5zY2VuZS5hZGQoIG5ldyBUSFJFRS5BbWJpZW50TGlnaHQoIDB4MjIyMjIyICkgKTtcblxuICAgICAgICAgICAgdmFyIGRpcmVjdGlvbmFsTGlnaHQgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCggMHhmZmZmZmYsIDIgKTtcblx0ICAgIGRpcmVjdGlvbmFsTGlnaHQucG9zaXRpb24uc2V0KCAyLCAxLjIsIDEwICkubm9ybWFsaXplKCk7XG5cdCAgICBhcHAuc2NlbmUuYWRkKCBkaXJlY3Rpb25hbExpZ2h0ICk7XG5cblx0ICAgIGRpcmVjdGlvbmFsTGlnaHQgPSBuZXcgVEhSRUUuRGlyZWN0aW9uYWxMaWdodCggMHhmZmZmZmYsIDEgKTtcblx0ICAgIGRpcmVjdGlvbmFsTGlnaHQucG9zaXRpb24uc2V0KCAtMiwgMS4yLCAtMTAgKS5ub3JtYWxpemUoKTtcblx0ICAgIGFwcC5zY2VuZS5hZGQoIGRpcmVjdGlvbmFsTGlnaHQgKTsgIFxuICAgICAgICAgICAgcmVzb2x2ZSggYXBwICk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFN3YXJtXG4gICAgLy8gLS0tLS1cbiAgICBmdW5jdGlvbiBtYWtlU3dhcm0gKCBhcHAgKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgcGFydGljbGVzID0gW107XG5cbiAgICAgICAgICAgIC8vIEFkZCB0byBTY2VuZVxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICBhcHAuc3dhcm1PYmplY3QzRCA9IG5ldyBUSFJFRS5PYmplY3QzRCgpO1xuICAgICAgICAgICAgYXBwLnNjZW5lLmFkZCggYXBwLnN3YXJtT2JqZWN0M0QgKTtcbiAgICAgICAgICAgIGFwcC5wcmVDdWJlQ2FtUmVuZGVyRm5zLnB1c2goIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBhcHAuc3dhcm1PYmplY3QzRC52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGFwcC5wb3N0Q3ViZUNhbVJlbmRlckZucy5wdXNoKCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXBwLnN3YXJtT2JqZWN0M0QudmlzaWJsZSA9IHRydWU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTG9hZGVyXG4gICAgICAgICAgICAvLyAtLS0tLS1cbiAgICAgICAgICAgIHZhciBsb2FkZXIgPSBuZXcgVEhSRUUuT0JKTG9hZGVyKCk7XG4gICAgICAgICAgICBsb2FkZXIubG9hZCggJy9vYmovcGlsbG93LWJveC5vYmonLCBvbk9iakxvYWRlZCApO1xuXG4gICAgICAgICAgICAvLyBTd2FybSBDcmVhdGlvblxuICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgZnVuY3Rpb24gb25PYmpMb2FkZWQgKCBvYmogKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgbWVzaCA9IG9iai5jaGlsZHJlblsgMCBdO1xuXG4gICAgICAgICAgICAgICAgLy8gUGFydGljbGUgQ3JlYXRpb25cbiAgICAgICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgIC8vIEVhc2UgaW4gdGhlIGNyZWF0aW9uIG9mIHRoZSBwYXJ0aWNsZXNcbiAgICAgICAgICAgICAgICB2YXIgbWF4UGFydGljbGVzID0gMTAwO1xuICAgICAgICAgICAgICAgIHZhciBtaW5DcmVhdGlvblRpbWUgPSA1O1xuICAgICAgICAgICAgICAgIHZhciBtYXhDcmVhdGlvblRpbWVNUyA9IDEwMDtcblxuICAgICAgICAgICAgICAgIHZhciBtYXRlcmlhbCA9IFxuICAgICAgICAgICAgICAgIChmdW5jdGlvbiBjcmVhdGVNb3JlICgpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBwYXJ0aWNsZXMubGVuZ3RoIDwgbWF4UGFydGljbGVzICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnRpY2xlID0gbmV3IFBhcnRpY2xlKCBtZXNoICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcHAuc3dhcm1PYmplY3QzRC5hZGQoIHBhcnRpY2xlLmFuY2hvciApO1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFydGljbGVzLnB1c2goIHBhcnRpY2xlICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCBjcmVhdGVNb3JlLCBXLm1hcCggcGFydGljbGVzLmxlbmd0aCAvIG1heFBhcnRpY2xlcywgMCwgMSwgbWF4Q3JlYXRpb25UaW1lTVMsIG1pbkNyZWF0aW9uVGltZSwgVy5pbnRlcnBvbGF0aW9ucy5lYXNlSW4gKSApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSgpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gVXBkYXRpbmdcbiAgICAgICAgICAgIGFkZFByZVJlbmRlckZuKCBhcHAsIGZ1bmN0aW9uICggZGVsdGFNUywgdGltZXN0YW1wTVMgKSB7XG4gICAgICAgICAgICAgICAgcGFydGljbGVzLmZvckVhY2goIHBhcnRpY2xlID0+IHBhcnRpY2xlLnVwZGF0ZSggZGVsdGFNUywgdGltZXN0YW1wTVMgKSApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFBhcnRpY2xlIENsYXNzXG4gICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgZnVuY3Rpb24gUGFydGljbGUgKCBtZXNoICkge1xuXG4gICAgICAgICAgICAgICAgdGhpcy52ZWxvY2l0eSA9IFcucmFuZG9tQmV0d2VlbiggMC4yLCAxICk7XG5cbiAgICAgICAgICAgICAgICAvLyBNZXNoXG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoID0gbWVzaC5jbG9uZSgpO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzaC5tYXRlcmlhbCA9IFBhcnRpY2xlLm1hdGVyaWFsLmNsb25lKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLnNjYWxlLnggPSBQYXJ0aWNsZS5pbml0aWFsU2NhbGU7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLnNjYWxlLnkgPSBQYXJ0aWNsZS5pbml0aWFsU2NhbGU7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNoLnNjYWxlLnogPSBQYXJ0aWNsZS5pbml0aWFsU2NhbGU7XG5cbiAgICAgICAgICAgICAgICAvLyBQb3NpdGlvblxuICAgICAgICAgICAgICAgIHZhciByYW5nZSA9IDEwMDtcbiAgICAgICAgICAgICAgICB0aGlzLm1lc2gucG9zaXRpb24uc2V0KCAoIE1hdGgucmFuZG9tKCkgLSAwLjUgKSAqIHJhbmdlLCAoIE1hdGgucmFuZG9tKCkgLSAwLjUgKSAqIHJhbmdlLCAoIE1hdGgucmFuZG9tKCkgLSAwLjUgKSAqIHJhbmdlICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuYW5jaG9yID0gbmV3IFRIUkVFLk9iamVjdDNEKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmNob3IuYWRkKCB0aGlzLm1lc2ggKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gIyMjIFN0YXRpY1xuICAgICAgICAgICAgUGFydGljbGUubWF0ZXJpYWwgPSBuZXcgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwoIHtcblx0XHRjb2xvcjogMHhmZmZmZmYsXG5cdFx0c2hpbmluZXNzOiAwLjAsXG5cdFx0c3BlY3VsYXI6IDB4ZmZmZmZmLFxuXHRcdGVudk1hcDogYXBwLmN1YmVDYW1lcmEucmVuZGVyVGFyZ2V0LFxuICAgICAgICAgICAgICAgIHJlZmxlY3Rpdml0eTogMS4wLFxuICAgICAgICAgICAgICAgIHNpZGU6IFRIUkVFLkRvdWJsZVNpZGVcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBQYXJ0aWNsZS5pbml0aWFsU2NhbGUgPSAyMDA7XG5cbiAgICAgICAgICAgIC8vICMjIyBNZXRob2RcbiAgICAgICAgICAgIFBhcnRpY2xlLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoIGRlbHRhTVMsIHRpbWVzdGFtcE1TICkge1xuICAgICAgICAgICAgICAgIHRoaXMuYW5jaG9yLnJvdGF0aW9uLnggKz0gMC4wMDI7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmNob3Iucm90YXRpb24ueSArPSB0aGlzLnZlbG9jaXR5IC8gMTA7XG4gICAgICAgICAgICAgICAgdGhpcy5hbmNob3Iucm90YXRpb24ueiArPSAwLjAwMTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBSZW5kZXIgTG9vcFxuICAgIC8vIC0tLS0tLS0tLS0tXG4gICAgZnVuY3Rpb24gbWFrZVJlbmRlckxvb3AgKCBhcHAgKSB7XG4gICAgICAgIHJldHVybiBXLnByb21pc2UoIGZ1bmN0aW9uICggcmVzb2x2ZSwgcmVqZWN0ICkge1xuXG4gICAgICAgICAgICB2YXIgbGFzdFRpbWVzdGFtcE1TID0gMDtcbiAgICAgICAgICAgIHZhciBkZWx0YU1TID0gMDtcblxuICAgICAgICAgICAgKGZ1bmN0aW9uICBsb29wICggY3VycmVudFRpbWVzdGFtcE1TICkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlY3VyXG4gICAgICAgICAgICAgICAgLy8gLS0tLS1cbiAgICAgICAgICAgICAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCBsb29wICk7XG5cbiAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGltZXN0YW1wc1xuICAgICAgICAgICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgIGRlbHRhTVMgPSBjdXJyZW50VGltZXN0YW1wTVMgLSBsYXN0VGltZXN0YW1wTVM7XG4gICAgICAgICAgICAgICAgbGFzdFRpbWVzdGFtcE1TID0gY3VycmVudFRpbWVzdGFtcE1TO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIEFjdGlvbmFibGVzXG4gICAgICAgICAgICAgICAgLy8gLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgICBhcHAucHJlUmVuZGVyRm5zLmZvckVhY2goIGZuID0+IGZuKCBkZWx0YU1TLCBjdXJyZW50VGltZXN0YW1wTVMgKSApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFJlbmRlclxuICAgICAgICAgICAgICAgIC8vIC0tLS0tLVxuICAgICAgICAgICAgICAgIGFwcC5yZW5kZXJlci5jbGVhcigpO1xuXHRcdGFwcC5yZW5kZXJlci5yZW5kZXIoIGFwcC5zY2VuZSwgYXBwLmNhbWVyYSApO1xuXG4gICAgICAgICAgICB9KCBsYXN0VGltZXN0YW1wTVMgKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJlc29sdmUoIGFwcCApO1xuICAgICAgICB9KTtcblxuICAgIH1cblxuICAgIC8vIFV0aWxzXG4gICAgLy8gPT09PT1cblxuICAgIC8vIFJlbmRlciBMb29wXG4gICAgLy8gLS0tLS0tLS0tLS1cbiAgICBmdW5jdGlvbiBhZGRQcmVSZW5kZXJGbiAoIGFwcCwgZm4gKSB7XG4gICAgICAgIGFwcC5wcmVSZW5kZXJGbnMucHVzaCggZm4gKTtcbiAgICB9XG5cbiAgICAvLyBDYW1lcmFcbiAgICAvLyAtLS0tLS1cbiAgICBmdW5jdGlvbiBzZXRDYW1lcmFQb3NpdGlvbiAoIGFwcCwgeCwgeSwgeiApIHtcbiAgICAgICAgYXBwLmNhbWVyYS5wb3NpdGlvbi54ID0geDtcbiAgICAgICAgYXBwLmNhbWVyYS5wb3NpdGlvbi55ID0geTtcbiAgICAgICAgYXBwLmNhbWVyYS5wb3NpdGlvbi56ID0gejtcbiAgICB9XG4gXG4gICAgLy8gRXhwb3J0XG4gICAgLy8gPT09PT09ICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIG1ha2VBcHA6IG1ha2VBcHAsXG4gICAgICAgIGluaXRBcHA6IGluaXRBcHAgIFxuICAgIH07XG4gICAgXG59KCkpO1xuXG5cblxuXG5cblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9